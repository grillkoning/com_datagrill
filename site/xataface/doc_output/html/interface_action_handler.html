<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>Xataface: ActionHandler Interface Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xataface-logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Xataface
   &#160;<span id="projectnumber">2.0alpha2</span>
   </div>
   <div id="projectbrief">Xataface Application Framework</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="classes.html"><span>Data&#160;Structure&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Data&#160;Fields</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">ActionHandler Interface Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Interface for action handlers in Xataface application. An action handler serves as an HTTP access point for an application. Actions may be located in the following locations:  
 <a href="interface_action_handler.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a4ea58d0d4ac6d4ef7456e09dc108bb56"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_action_handler.html#a4ea58d0d4ac6d4ef7456e09dc108bb56">handle</a> ($params)</td></tr>
<tr class="memdesc:a4ea58d0d4ac6d4ef7456e09dc108bb56"><td class="mdescLeft">&#160;</td><td class="mdescRight">The entry point for this action.  <a href="#a4ea58d0d4ac6d4ef7456e09dc108bb56">More...</a><br/></td></tr>
<tr class="separator:a4ea58d0d4ac6d4ef7456e09dc108bb56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa691e5effe521f489d0dd2a41484c5d5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_action_handler.html#aa691e5effe521f489d0dd2a41484c5d5">getPermissions</a> ($params)</td></tr>
<tr class="memdesc:aa691e5effe521f489d0dd2a41484c5d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">An optional method to override the permissions granted to the current user when this action is requested. This option is not often used and it is questionable whether it is of any value since permissions can be amply defined in the table or application delegate classes.  <a href="#aa691e5effe521f489d0dd2a41484c5d5">More...</a><br/></td></tr>
<tr class="separator:aa691e5effe521f489d0dd2a41484c5d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Interface for action handlers in Xataface application. An action handler serves as an HTTP access point for an application. Actions may be located in the following locations: </p>
<ol type="1">
<li>DATAFACE_SITE_PATH%/tables/tablename%/actions/actionname%.php</li>
<li>DATAFACE_SITE_PATH%/actions/actionname%.php</li>
<li>DATAFACE_SITE_PATH%/modules/modulename%/actions/actionname%.php</li>
<li>DATAFACE_PATH/actions/actionname%.php</li>
</ol>
<p>The action file should contain a class with a name that roughly matches the path to the file.</p>
<p>E.g. An action in the tables/tablename%/actions/actionname%.php file should be named <code>tables_tablename_actions_actionname%</code> . Similarly an action in the actions/actionname%.php file should be named <code>actions_actionname%</code> etc...</p>
<p>This interface serves to document the available methods that may be defined in an action handler and how they are expected to work.</p>
<dl class="section user"><dt>Example Action</dt><dd></dd></dl>
<p>Consider a sample action located in the <code>DATAFACE_SITE_PATH%/actions/myaction</code>.php file:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>actions_myaction {</div>
<div class="line">    <span class="keyword">function</span> <a class="code" href="interface_action_handler.html#a4ea58d0d4ac6d4ef7456e09dc108bb56" title="The entry point for this action.">handle</a>($params){</div>
<div class="line">        echo <span class="stringliteral">&quot;Hello World&quot;</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="action_config_with_actions_ini"></a>
Configuration With The actions.ini file</h1>
<p>An action handler is the PHP portion of an action that is defined in the <a href="http://xataface.com/wiki/actions.ini_file">actions.ini file</a>. The actions.ini file allows you to decide where the action appears in the application's user interface as well as such things as permissions. You can also define permissions programmatically inside your action.</p>
<dl class="section author"><dt>Author</dt><dd>Steve Hannah <a href="#" onclick="location.href='mai'+'lto:'+'ste'+'ve'+'@we'+'bl'+'ite'+'.c'+'a'; return false;">steve<span style="display: none;">.nosp@m.</span>@web<span style="display: none;">.nosp@m.</span>lite.<span style="display: none;">.nosp@m.</span>ca</a>  Nov. 26, 2011 </dd></dl>

<p>Definition at line <a class="el" href="_action_handler_8php_source.html#l00048">48</a> of file <a class="el" href="_action_handler_8php_source.html">ActionHandler.php</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="aa691e5effe521f489d0dd2a41484c5d5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getPermissions </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$params</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>An optional method to override the permissions granted to the current user when this action is requested. This option is not often used and it is questionable whether it is of any value since permissions can be amply defined in the table or application delegate classes. </p>
<p>array $params The parameters. </p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="class_dataface___table.html#a2c2976d90b444715ac971add03b2d528" title="Obtains the permissions for a particular record or for this table. Parameters are passed in associati...">Dataface_Table::getPermissions()</a> for available parameters. </dd></dl>

</div>
</div>
<a class="anchor" id="a4ea58d0d4ac6d4ef7456e09dc108bb56"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">handle </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$params</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The entry point for this action. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$params</td><td>Parameters passed to the action to determine how the action should be executed. The only key that is currently set to be passed is <code>relationship</code> but this can equivalently be obtained from the <code>$query</code>['-relationship'] Query parameter.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mixed If this method returns a <a class="el" href="class_p_e_a_r___error.html">PEAR_Error</a> object, then Xataface will do some additional processing depending on the type of error.</dd></dl>
<dl class="section user"><dt>Dealing with Permission Denied Errors</dt><dd></dd></dl>
<p>If during the course of execution the current user is deemed to lack sufficient permission to perform this action, then <a class="el" href="interface_action_handler.html#a4ea58d0d4ac6d4ef7456e09dc108bb56" title="The entry point for this action.">handle()</a> may return a <a class="el" href="class_p_e_a_r___error.html">PEAR_Error</a> with the code <code>DATAFACE_E_PERMISSION_DENIED</code>. Equivalently it may return the result of the <a class="el" href="class_dataface___error.html#af326456319a1a38b3ae0c9a1942e1458">Dataface_Error::permissionDenied()</a> method:</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> ( !$record-&gt;<a class="code" href="class_dataface___record.html#a1d200d9415c0733c0762d3adb928e9ed" title="Checks to see is a particular permission is granted in this record.">checkPermission</a>(<span class="stringliteral">&#39;view&#39;</span>) ){</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="class_dataface___error.html#af326456319a1a38b3ae0c9a1942e1458">Dataface_Error::permissionDenied</a>(<span class="stringliteral">&quot;You don&#39;t have permission for this.&quot;</span>);</div>
<div class="line">}</div>
</div><!-- fragment --><dl class="section user"><dt>Request Not Handled Errors</dt><dd></dd></dl>
<p>It is also possible to signal to Xataface that the action opted not to handle the request at all, so that Xataface will pass the opportunity to handle the request onto the next elligible action handler. This allows you to define handlers specific to a table that may override default actions or choose to just allow the default action to handle it.</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>tables_mytable_actions_list {</div>
<div class="line">    <span class="keyword">function</span> <a class="code" href="interface_action_handler.html#a4ea58d0d4ac6d4ef7456e09dc108bb56" title="The entry point for this action.">handle</a>($params){</div>
<div class="line">        $query = <a class="code" href="class_dataface___application.html#a9eb606fdb589cab3ae9edc96dce15972" title="Returns reference to the singleton instance of this class.">Dataface_Application::getInstance</a>()-&gt;getQuery();</div>
<div class="line">        <span class="keywordflow">if</span> ( !@$query[<span class="stringliteral">&#39;foo&#39;</span>] ) <span class="keywordflow">return</span> <a class="code" href="class_p_e_a_r.html#af25642dd23a403015692fb6a3402332b">PEAR::raiseError</a>(</div>
<div class="line">            <span class="stringliteral">&#39;WE only handle requests when the foo parameter is provided.  Use the default list action.&#39;</span>,</div>
<div class="line">            <a class="code" href="_error_8php.html#a92b5fd61ad09b3f80ab10d9a3f6d511c">DATAFACE_E_REQUEST_NOT_HANDLED</a></div>
<div class="line">         );</div>
<div class="line">         echo <span class="stringliteral">&quot;WE are handling this request ourselves.&quot;</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<hr/>The documentation for this interface was generated from the following file:<ul>
<li>Dataface/<a class="el" href="_action_handler_8php_source.html">ActionHandler.php</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon May 5 2014 09:52:19 for Xataface by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
