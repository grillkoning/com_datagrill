<html><head><meta http-equiv="content-type" content="text/html; charset=UTF-8"> <style>
	.KEYW {color: #933;}
	.COMM {color: #bbb; font-style: italic;}
	.NUMB {color: #393;}
	.STRN {color: #393;}
	.REGX {color: #339;}
	.line {border-right: 1px dotted #666; color: #666; font-style: normal;}
	</style></head><body><pre><span class='line'>  1</span> <span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">Dataface</span><span class="PUNC">==</span><span class="STRN">'undefined'</span><span class="PUNC">)</span><span class="NAME">Dataface</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Dataface.Calendar</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">id</span><span class="PUNC">,</span><span class="NAME">date</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">id</span><span class="PUNC">)</span><span class="NAME">id</span><span class="PUNC">=</span><span class="STRN">'df-calendar-'</span><span class="PUNC">+</span><span class="NAME">Math.random</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">date</span><span class="PUNC">)</span><span class="NAME">date</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">date</span><span class="PUNC">!=</span><span class="STRN">'Date'</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.setTime</span><span class="PUNC">(</span><span class="NAME">date</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">date</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>  2</span> </span><span class="NAME">this.selectedDate</span><span class="PUNC">=</span><span class="NAME">date</span><span class="PUNC">;</span><span class="NAME">this.id</span><span class="PUNC">=</span><span class="NAME">id</span><span class="PUNC">;</span><span class="NAME">Dataface.Calendar.addInstance</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Dataface.Calendar.instances</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Dataface.Calendar.addInstance</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">calendar</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.instances</span><span class="PUNC">[</span><span class="NAME">calendar.id</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">calendar</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Dataface.Calendar.getInstance</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">id</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.instances</span><span class="PUNC">[</span><span class="NAME">id</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Dataface.Calendar.prototype</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="STRN">'selectedEvent'</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">'selectedDate'</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="STRN">'defaultStartTime'</span><span class="PUNC">:</span><span class="NUMB">8</span><span class="PUNC">,</span><span class="STRN">'defaultEndTime'</span><span class="PUNC">:</span><span class="NUMB">22</span><span class="PUNC">,</span><span class="STRN">'monthPanel'</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">'weekPanel'</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">'dayPanel'</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">'detailsPanel'</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">'handleSelectDay'</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">date</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">date</span><span class="PUNC">!=</span><span class="STRN">'Date'</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">date</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">(</span><span class="NAME">date</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>  3</span> </span><span class="NAME">this.selectedDate</span><span class="PUNC">=</span><span class="NAME">date</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.dayPanel</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="NAME">this.dayPanel</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">innerHTML</span><span class="PUNC">=</span><span class="NAME">this.drawDay</span><span class="PUNC">(</span><span class="NUMB">9</span><span class="PUNC">,</span><span class="NUMB">21</span><span class="PUNC">,</span><span class="NUMB">0.25</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="STRN">'handleSelectEvent'</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.selectedEvent</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">eventDiv</span><span class="PUNC">=</span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="STRN">'event-preview-'</span><span class="PUNC">+</span><span class="NAME">this.selectedEvent.id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">cls</span><span class="PUNC">=</span><span class="NAME">eventDiv.className</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">cls</span><span class="PUNC">)</span><span class="NAME">cls</span><span class="PUNC">=</span><span class="STRN">''</span><span class="PUNC">;</span><span class="NAME">eventDiv.className</span><span class="PUNC">=</span><span class="NAME">cls.replace</span><span class="PUNC">(</span><span class="REGX">/Dataface-Calendar-selected-event/</span><span class="PUNC">,</span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>  4</span> </span><span class="NAME">this.selectedEvent</span><span class="PUNC">=</span><span class="NAME">Dataface.Calendar.Event.getInstance</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.detailsPanel</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="NAME">this.detailsPanel</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">innerHTML</span><span class="PUNC">=</span><span class="NAME">this.selectedEvent.showDetails</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>  5</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">div</span><span class="PUNC">=</span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="STRN">'event-preview-'</span><span class="PUNC">+</span><span class="NAME">this.selectedEvent.id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">cls2</span><span class="PUNC">=</span><span class="NAME">div.className</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">cls2</span><span class="PUNC">)</span><span class="NAME">cls2</span><span class="PUNC">=</span><span class="STRN">''</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">div</span><span class="PUNC">)</span><span class="NAME">div.className</span><span class="PUNC">=</span><span class="NAME">cls2</span><span class="PUNC">+</span><span class="STRN">' Dataface-Calendar-selected-event'</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Dataface.Calendar.Event</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">id</span><span class="PUNC">,</span><span class="NAME">data</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.id</span><span class="PUNC">=</span><span class="STRN">'event-'</span><span class="PUNC">+</span><span class="NAME">Math.random</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">data</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">==</span><span class="STRN">'date'</span><span class="PUNC">||</span><span class="NAME">key</span><span class="PUNC">==</span><span class="STRN">'endTime'</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">data</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">!=</span><span class="STRN">'Date'</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.setTime</span><span class="PUNC">(</span><span class="NAME">data</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">d.getTimezoneOffset</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NUMB">60</span><span class="PUNC">*</span><span class="NUMB">1000</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">data</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>  6</span> </span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">data</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>  7</span> </span><span class="NAME">Dataface.Calendar.Event.addInstance</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Dataface.Calendar.Event.instances</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Dataface.Calendar.Event.addInstance</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.instances</span><span class="PUNC">[</span><span class="NAME">event.id</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">event</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Dataface.Calendar.Event.getInstance</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">id</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.instances</span><span class="PUNC">[</span><span class="NAME">id</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Dataface.Calendar.Event.prototype</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="STRN">'title'</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">'date'</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">'endTime'</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">'description'</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">'url'</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">'showDetails'</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">out</span><span class="PUNC">=</span><span class="STRN">'&lt;div "Dataface-Calendar-details">'</span><span class="PUNC">;</span><span class="NAME">out</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="STRN">'&lt;h3 class="Dataface-Calendar-details-title">'</span><span class="PUNC">+</span><span class="NAME">this.title</span><span class="PUNC">+</span><span class="STRN">'&lt;/h3>'</span><span class="PUNC">;</span><span class="NAME">out</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="STRN">'&lt;table class="Dataface-Calendar-details-data">&lt;tbody>'</span><span class="PUNC">;</span><span class="NAME">out</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="STRN">'&lt;tr>&lt;th>from&lt;/th>&lt;td>'</span><span class="PUNC">+</span><span class="NAME">this.date.asString</span><span class="PUNC">(</span><span class="STRN">'%Y-%m-%d'</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">' at '</span><span class="PUNC">+</span><span class="NAME">this.date.asString</span><span class="PUNC">(</span><span class="STRN">'%H:%i'</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">'&lt;/td>&lt;/tr>'</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.endTime</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">out</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="STRN">'&lt;tr>&lt;th>to&lt;/th>&lt;td>'</span><span class="PUNC">+</span><span class="NAME">this.endTime.asString</span><span class="PUNC">(</span><span class="STRN">'%Y-%m-%d'</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">' at '</span><span class="PUNC">+</span><span class="NAME">this.endTime.asString</span><span class="PUNC">(</span><span class="STRN">'%H:%i'</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">'&lt;/td>&lt;/tr>'</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>  8</span> </span><span class="NAME">out</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="STRN">'&lt;/table>'</span><span class="PUNC">;</span><span class="NAME">out</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="STRN">'&lt;div class="Dataface-Calendar-details-description">'</span><span class="PUNC">+</span><span class="NAME">this.getDescription</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">'&lt;/div>'</span><span class="PUNC">;</span><span class="NAME">out</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="STRN">' &lt;/div>'</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">out</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="STRN">'getDescription'</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.description</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Dataface.Calendar.prototype.events</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="STRN">'list'</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">'sorted'</span><span class="PUNC">:</span><span class="KEYW">false</span><span class="PUNC">,</span><span class="STRN">'add'</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.list</span><span class="PUNC">[</span><span class="NAME">this.list.length</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">this.sorted</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="STRN">'compare'</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">a.date.getTime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">&lt;</span><span class="NAME">a.date.getTime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="STRN">'sort'</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.sorted</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.list.sort</span><span class="PUNC">(</span><span class="NAME">this.compare</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="STRN">'month'</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">date</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.sort</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">out</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">this.list.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.list</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">e.date.getFullYear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">date.getFullYear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e.date.getMonth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">date.getMonth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">out</span><span class="PUNC">[</span><span class="NAME">out.length</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">this.list</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>  9</span> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">out</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="STRN">'day'</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">date</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.sort</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">out</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">this.list.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.list</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">e.date.getFullYear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">date.getFullYear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e.date.getMonth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">date.getMonth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e.date.getDate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">date.getDate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">out</span><span class="PUNC">[</span><span class="NAME">out.length</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">this.list</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 10</span> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">out</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="STRN">'week'</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">date</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.sort</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">firstDay</span><span class="PUNC">=</span><span class="NAME">date.getDate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">date.getDay</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">lastDay</span><span class="PUNC">=</span><span class="NAME">date.getDate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NUMB">6</span><span class="PUNC">-</span><span class="NAME">date.getDay</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">out</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">this.list.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.list</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">e.date.getFullYear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">date.getFullYear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e.date.getMonth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">date.getMonth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e.date.getDate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">>=</span><span class="NAME">firstDay</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e.date.getDate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">&lt;=</span><span class="NAME">lastDay</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">out</span><span class="PUNC">[</span><span class="NAME">out.length</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">this.list</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 11</span> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">out</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="STRN">'range'</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">start</span><span class="PUNC">,</span><span class="NAME">end</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.sort</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">out</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">this.list.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.list</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">start.getTime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">&lt;=</span><span class="NAME">e.date.getTime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">end.getTime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">></span><span class="NAME">e.date.getTime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">out</span><span class="PUNC">[</span><span class="NAME">out.length</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 12</span> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">out</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Date.daysOfWeek</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="STRN">'Sunday'</span><span class="PUNC">,</span><span class="STRN">'Monday'</span><span class="PUNC">,</span><span class="STRN">'Tuesday'</span><span class="PUNC">,</span><span class="STRN">'Wednesday'</span><span class="PUNC">,</span><span class="STRN">'Thursday'</span><span class="PUNC">,</span><span class="STRN">'Friday'</span><span class="PUNC">,</span><span class="STRN">'Saturday'</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">Date.monthsOfYear</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="STRN">'January'</span><span class="PUNC">,</span><span class="STRN">'February'</span><span class="PUNC">,</span><span class="STRN">'March'</span><span class="PUNC">,</span><span class="STRN">'April'</span><span class="PUNC">,</span><span class="STRN">'May'</span><span class="PUNC">,</span><span class="STRN">'June'</span><span class="PUNC">,</span><span class="STRN">'July'</span><span class="PUNC">,</span><span class="STRN">'August'</span><span class="PUNC">,</span><span class="STRN">'September'</span><span class="PUNC">,</span><span class="STRN">'October'</span><span class="PUNC">,</span><span class="STRN">'November'</span><span class="PUNC">,</span><span class="STRN">'December'</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">Date.prototype.daysInMonth</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">32</span><span class="PUNC">-</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">(</span><span class="NAME">this.getFullYear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.getMonth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">32</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getDate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 13</span> </span><span class="NAME">Dataface.Calendar.prototype.drawMonth</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">firstDay</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">(</span><span class="NAME">this.selectedDate.getFullYear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.selectedDate.getMonth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">out</span><span class="PUNC">=</span><span class="STRN">'&lt;table class="Dataface-Calendar-month" cellspacing="0">&lt;thead>&lt;tr>&lt;th>'</span><span class="PUNC">+</span><span class="NAME">Date.daysOfWeek.join</span><span class="PUNC">(</span><span class="STRN">'&lt;/th>&lt;th>'</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">'&lt;/th>&lt;/tr>&lt;/thead>'</span><span class="PUNC">;</span><span class="NAME">out</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="STRN">'&lt;tbody>'</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">day</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NUMB">5</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">out</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="STRN">'&lt;tr>'</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">&lt;</span><span class="NUMB">7</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">day</span><span class="PUNC">==</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">firstDay.getDay</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">day</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 14</span> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">day</span><span class="PUNC">==</span><span class="NAME">this.selectedDate.daysInMonth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">day</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 15</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">cls</span><span class="PUNC">=</span><span class="STRN">''</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">day</span><span class="PUNC">>=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="NAME">cls</span><span class="PUNC">=</span><span class="STRN">'Dataface-Calendar-day'</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">cls</span><span class="PUNC">=</span><span class="STRN">'Dataface-Calendar-empty-day'</span><span class="PUNC">;</span><span class="NAME">out</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="STRN">'&lt;td class="'</span><span class="PUNC">+</span><span class="NAME">cls</span><span class="PUNC">+</span><span class="STRN">'">&lt;div class="day-wrapper"'</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">day</span><span class="PUNC">>=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">currDay</span><span class="PUNC">=</span><span class="NAME">this.selectedDate.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">currDay.setDate</span><span class="PUNC">(</span><span class="NAME">day</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">out</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="STRN">'&lt;div class="day-number">&lt;a href="javascript:Dataface.Calendar.getInstance(\''</span><span class="PUNC">+</span><span class="NAME">this.id</span><span class="PUNC">+</span><span class="STRN">'\').handleSelectDay(\''</span><span class="PUNC">+</span><span class="NAME">currDay.toString</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">'\')">'</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">day</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">'&lt;/a>&lt;/div>'</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">events</span><span class="PUNC">=</span><span class="NAME">this.events.day</span><span class="PUNC">(</span><span class="NAME">currDay</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">k</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">k</span><span class="PUNC">&lt;</span><span class="NAME">events.length</span><span class="PUNC">;</span><span class="NAME">k</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">out</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="STRN">'&lt;div class="Dataface-Calendar-event" id="event-preview-'</span><span class="PUNC">+</span><span class="NAME">events</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">id</span><span class="PUNC">+</span><span class="STRN">'">&lt;a href="javascript:Dataface.Calendar.getInstance(\''</span><span class="PUNC">+</span><span class="NAME">this.id</span><span class="PUNC">+</span><span class="STRN">'\').handleSelectEvent(\''</span><span class="PUNC">+</span><span class="NAME">events</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">id</span><span class="PUNC">+</span><span class="STRN">'\');">'</span><span class="PUNC">+</span><span class="NAME">events</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">title</span><span class="PUNC">+</span><span class="STRN">'&lt;/a>&lt;/div>'</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 16</span> </span><span class="NAME">day</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 17</span> </span><span class="NAME">out</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="STRN">'&lt;/div>&lt;/td>'</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 18</span> </span><span class="NAME">out</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="STRN">'&lt;/tr>'</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 19</span> </span><span class="NAME">out</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="STRN">'&lt;/tbody>&lt;/table>'</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">out</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Dataface.Calendar.prototype.drawWeek</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">startHour</span><span class="PUNC">,</span><span class="NAME">endHour</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">startHour</span><span class="PUNC">)</span><span class="NAME">startHour</span><span class="PUNC">=</span><span class="NUMB">8</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">endHour</span><span class="PUNC">)</span><span class="NAME">endHour</span><span class="PUNC">=</span><span class="NUMB">20</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">thisDayOfWeek</span><span class="PUNC">=</span><span class="NAME">this.selectedDate.getDay</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">thisWeeksFirstDay</span><span class="PUNC">=</span><span class="NAME">this.selectedDate.getDate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">this.selectedDate.getDay</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">headings</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">Date.daysOfWeek.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">date</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">(</span><span class="NAME">this.selectedDate.getFullYear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.selectedDate.getMonth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">thisWeeksFirstDay</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">headings</span><span class="PUNC">[</span><span class="NAME">headings.length</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Date.daysOfWeek</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="STRN">' '</span><span class="PUNC">+</span><span class="NAME">Date.monthsOfYear</span><span class="PUNC">[</span><span class="NAME">date.getMonth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="STRN">' '</span><span class="PUNC">+</span><span class="NAME">date.getDate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">', '</span><span class="PUNC">+</span><span class="NAME">date.getFullYear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 20</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">out</span><span class="PUNC">=</span><span class="STRN">'&lt;table class="jsCalendar-week">&lt;thead>&lt;tr>&lt;th>&lt;/th>&lt;th>'</span><span class="PUNC">+</span><span class="NAME">headings.join</span><span class="PUNC">(</span><span class="STRN">'&lt;/th>&lt;th>'</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">'&lt;/th>&lt;/tr>&lt;/thead>'</span><span class="PUNC">;</span><span class="NAME">out</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="STRN">'&lt;tbody>'</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">hour</span><span class="PUNC">=</span><span class="NAME">startHour</span><span class="PUNC">;</span><span class="NAME">hour</span><span class="PUNC">&lt;=</span><span class="NAME">endHour</span><span class="PUNC">;</span><span class="NAME">hour</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">out</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="STRN">'&lt;tr>&lt;th>'</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">hour</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">':00&lt;/th>'</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">&lt;</span><span class="NAME">Date.daysOfWeek.length</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">out</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="STRN">'&lt;td>&lt;/td>'</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 21</span> </span><span class="NAME">out</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="STRN">'&lt;/tr>'</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 22</span> </span><span class="NAME">out</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="STRN">'&lt;/tbody>&lt;/table>'</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">out</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Dataface.Calendar.prototype.drawDay</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">startHour</span><span class="PUNC">,</span><span class="NAME">endHour</span><span class="PUNC">,</span><span class="NAME">precision</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">startHour</span><span class="PUNC">)</span><span class="NAME">startHour</span><span class="PUNC">=</span><span class="NUMB">8</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">endHour</span><span class="PUNC">)</span><span class="NAME">endHour</span><span class="PUNC">=</span><span class="NUMB">20</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">precision</span><span class="PUNC">)</span><span class="NAME">precision</span><span class="PUNC">=</span><span class="NUMB">1.0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">thisDayOfWeek</span><span class="PUNC">=</span><span class="NAME">this.selectedDate.getDay</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">thisWeeksFirstDay</span><span class="PUNC">=</span><span class="NAME">this.selectedDate.getDate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">this.selectedDate.getDay</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">headings</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">Date.daysOfWeek.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">date</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">(</span><span class="NAME">this.selectedDate.getFullYear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.selectedDate.getMonth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">thisWeeksFirstDay</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">headings</span><span class="PUNC">[</span><span class="NAME">headings.length</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Date.daysOfWeek</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="STRN">' '</span><span class="PUNC">+</span><span class="NAME">Date.monthsOfYear</span><span class="PUNC">[</span><span class="NAME">date.getMonth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="STRN">' '</span><span class="PUNC">+</span><span class="NAME">date.getDate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">', '</span><span class="PUNC">+</span><span class="NAME">date.getFullYear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 23</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">out</span><span class="PUNC">=</span><span class="STRN">'&lt;table class="jsCalendar-week">&lt;thead>&lt;tr>&lt;th>&lt;/th>&lt;th>'</span><span class="PUNC">+</span><span class="NAME">headings</span><span class="PUNC">[</span><span class="NAME">this.selectedDate.getDay</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="STRN">'&lt;/th>&lt;/thead>'</span><span class="PUNC">;</span><span class="NAME">out</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="STRN">'&lt;tbody>'</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">startTimems</span><span class="PUNC">=</span><span class="NAME">this.selectedDate.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">startTimems.setHours</span><span class="PUNC">(</span><span class="NAME">startHour</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">startTimems.setMinutes</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">startTimems.setSeconds</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">endTimems</span><span class="PUNC">=</span><span class="NAME">this.selectedDate.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">endTimems.setHours</span><span class="PUNC">(</span><span class="NAME">endHour</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">endTimems.setMinutes</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">endTimems.setSeconds</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">time</span><span class="PUNC">=</span><span class="NAME">startTimems.getTime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">time</span><span class="PUNC">&lt;=</span><span class="NAME">endTimems</span><span class="PUNC">;</span><span class="NAME">time</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">precision</span><span class="PUNC">*</span><span class="NUMB">60</span><span class="PUNC">*</span><span class="NUMB">60</span><span class="PUNC">*</span><span class="NUMB">1000</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">startTime</span><span class="PUNC">=</span><span class="NAME">this.selectedDate.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">startTime.setTime</span><span class="PUNC">(</span><span class="NAME">time</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">minutes</span><span class="PUNC">=</span><span class="NAME">startTime.getMinutes</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">""</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">minutes.length</span><span class="PUNC">==</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="NAME">minutes</span><span class="PUNC">=</span><span class="STRN">'0'</span><span class="PUNC">+</span><span class="NAME">minutes</span><span class="PUNC">;</span><span class="NAME">out</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="STRN">'&lt;tr>&lt;th>'</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">startTime.getHours</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">':'</span><span class="PUNC">+</span><span class="NAME">minutes</span><span class="PUNC">+</span><span class="STRN">'&lt;/th>'</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">endTime</span><span class="PUNC">=</span><span class="NAME">this.selectedDate.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">endTime.setTime</span><span class="PUNC">(</span><span class="NAME">time</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">precision</span><span class="PUNC">*</span><span class="NUMB">60</span><span class="PUNC">*</span><span class="NUMB">60</span><span class="PUNC">*</span><span class="NUMB">1000</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">events</span><span class="PUNC">=</span><span class="NAME">this.events.range</span><span class="PUNC">(</span><span class="NAME">startTime</span><span class="PUNC">,</span><span class="NAME">endTime</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">out</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="STRN">'&lt;td>'</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">&lt;</span><span class="NAME">events.length</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">out</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="STRN">'&lt;div class="jsCalendar-event">&lt;a href="javascript:Dataface.Calendar.getInstance(\''</span><span class="PUNC">+</span><span class="NAME">this.id</span><span class="PUNC">+</span><span class="STRN">'\').handleSelectEvent(\''</span><span class="PUNC">+</span><span class="NAME">events</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">id</span><span class="PUNC">+</span><span class="STRN">'\');">'</span><span class="PUNC">+</span><span class="NAME">events</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">title</span><span class="PUNC">+</span><span class="STRN">'&lt;/a>&lt;/div>'</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 24</span> </span><span class="NAME">out</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="STRN">'&lt;/td>&lt;/tr>'</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 25</span> </span><span class="NAME">out</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="STRN">'&lt;/tbody>&lt;/table>'</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">out</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Date.prototype.clone</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">(</span><span class="NAME">this.getFullYear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.getMonth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.getDate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.getHours</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.getMinutes</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.getSeconds</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Date.prototype.asString</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">format</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">out</span><span class="PUNC">=</span><span class="NAME">format.replace</span><span class="PUNC">(</span><span class="REGX">/%Y/</span><span class="PUNC">,</span><span class="NAME">this.getFullYear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">out</span><span class="PUNC">=</span><span class="NAME">out.replace</span><span class="PUNC">(</span><span class="REGX">/%m/</span><span class="PUNC">,</span><span class="NAME">pad</span><span class="PUNC">(</span><span class="NAME">this.getMonth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">out</span><span class="PUNC">=</span><span class="NAME">out.replace</span><span class="PUNC">(</span><span class="REGX">/%d/</span><span class="PUNC">,</span><span class="NAME">pad</span><span class="PUNC">(</span><span class="NAME">this.getDate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">out</span><span class="PUNC">=</span><span class="NAME">out.replace</span><span class="PUNC">(</span><span class="REGX">/%H/</span><span class="PUNC">,</span><span class="NAME">pad</span><span class="PUNC">(</span><span class="NAME">this.getHours</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">out</span><span class="PUNC">=</span><span class="NAME">out.replace</span><span class="PUNC">(</span><span class="REGX">/%i/</span><span class="PUNC">,</span><span class="NAME">pad</span><span class="PUNC">(</span><span class="NAME">this.getMinutes</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">out</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">pad</span><span class="PUNC">(</span><span class="NAME">number</span><span class="PUNC">,</span><span class="NAME">length</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">str</span><span class="PUNC">=</span><span class="STRN">''</span><span class="PUNC">+</span><span class="NAME">number</span><span class="PUNC">;</span><span class="KEYW">while</span><span class="PUNC">(</span><span class="NAME">str.length</span><span class="PUNC">&lt;</span><span class="NAME">length</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">str</span><span class="PUNC">=</span><span class="STRN">'0'</span><span class="PUNC">+</span><span class="NAME">str</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 26</span> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">str</span><span class="PUNC">;</span><span class="PUNC">}</span></pre></body></html>