<html><head><meta http-equiv="content-type" content="text/html; charset=UTF-8"> <style>
	.KEYW {color: #933;}
	.COMM {color: #bbb; font-style: italic;}
	.NUMB {color: #393;}
	.STRN {color: #393;}
	.REGX {color: #339;}
	.line {border-right: 1px dotted #666; color: #666; font-style: normal;}
	</style></head><body><pre><span class='line'>  1</span> <span class="COMM">/* NicEdit - Micro Inline WYSIWYG
<span class='line'>  2</span>  * Copyright 2007-2008 Brian Kirchoff
<span class='line'>  3</span>  *
<span class='line'>  4</span>  * NicEdit is distributed under the terms of the MIT license
<span class='line'>  5</span>  * For more information visit http://nicedit.com/
<span class='line'>  6</span>  * Do not remove this copyright message
<span class='line'>  7</span>  */</span><span class="WHIT">
<span class='line'>  8</span> 
<span class='line'>  9</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">bkExtend</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">arguments</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">A.length</span><span class="PUNC">==</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">A</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">A</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">B</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">A</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">B</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">bkClass</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="NAME">bkClass.prototype.construct</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">bkClass.extend</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">!==</span><span class="NAME">bkClass</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.construct.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">(</span><span class="NAME">bkClass</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">bkExtend</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">A.prototype</span><span class="PUNC">=</span><span class="NAME">B</span><span class="PUNC">;</span><span class="NAME">A.extend</span><span class="PUNC">=</span><span class="NAME">this.extend</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">bkElement</span><span class="PUNC">=</span><span class="NAME">bkClass.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">construct</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">$BK</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">appendTo</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">A.appendChild</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">appendBefore</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">A.parentNode.insertBefore</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">addEvent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">bkLib.addEvent</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setContent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.innerHTML</span><span class="PUNC">=</span><span class="NAME">A</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">pos</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">curtop</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">obj</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">obj.offsetParent</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">do</span><span class="PUNC">{</span><span class="NAME">C</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">obj.offsetLeft</span><span class="PUNC">;</span><span class="NAME">curtop</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">obj.offsetTop</span><span class="PUNC">}</span><span class="KEYW">while</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">=</span><span class="NAME">obj.offsetParent</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">window.opera</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this.getStyle</span><span class="PUNC">(</span><span class="STRN">"border-width"</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">this.style.border</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">[</span><span class="NAME">C</span><span class="PUNC">+</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NAME">curtop</span><span class="PUNC">+</span><span class="NAME">A</span><span class="PUNC">+</span><span class="NAME">this.offsetHeight</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">noSelect</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">bkLib.noSelect</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">parentTag</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="KEYW">do</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">&&</span><span class="NAME">B.nodeName</span><span class="PUNC">&&</span><span class="NAME">B.nodeName.toUpperCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">}</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">B.parentNode</span><span class="PUNC">}</span><span class="KEYW">while</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">hasClass</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.className.match</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">RegExp</span><span class="PUNC">(</span><span class="STRN">"(\\s|^)nicEdit-"</span><span class="PUNC">+</span><span class="NAME">A</span><span class="PUNC">+</span><span class="STRN">"(\\s|$)"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">addClass</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.hasClass</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.className</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="STRN">" nicEdit-"</span><span class="PUNC">+</span><span class="NAME">A</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">removeClass</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.hasClass</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.className</span><span class="PUNC">=</span><span class="NAME">this.className.replace</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">RegExp</span><span class="PUNC">(</span><span class="STRN">"(\\s|^)nicEdit-"</span><span class="PUNC">+</span><span class="NAME">A</span><span class="PUNC">+</span><span class="STRN">"(\\s|$)"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="STRN">" "</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setStyle</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">this.style</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">C</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="STRN">"float"</span><span class="PUNC">:</span><span class="NAME">B.cssFloat</span><span class="PUNC">=</span><span class="NAME">B.styleFloat</span><span class="PUNC">=</span><span class="NAME">A</span><span class="PUNC">[</span><span class="NAME">C</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="STRN">"opacity"</span><span class="PUNC">:</span><span class="NAME">B.opacity</span><span class="PUNC">=</span><span class="NAME">A</span><span class="PUNC">[</span><span class="NAME">C</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">B.filter</span><span class="PUNC">=</span><span class="STRN">"alpha(opacity="</span><span class="PUNC">+</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">[</span><span class="NAME">C</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NUMB">100</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">")"</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="STRN">"className"</span><span class="PUNC">:</span><span class="NAME">this.className</span><span class="PUNC">=</span><span class="NAME">A</span><span class="PUNC">[</span><span class="NAME">C</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="NAME">B</span><span class="PUNC">[</span><span class="NAME">C</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">A</span><span class="PUNC">[</span><span class="NAME">C</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getStyle</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">document.defaultView</span><span class="PUNC">:</span><span class="NAME">C</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.nodeType</span><span class="PUNC">==</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">&&</span><span class="NAME">B.getComputedStyle</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">B.getComputedStyle</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getPropertyValue</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.currentStyle</span><span class="PUNC">[</span><span class="NAME">bkLib.camelize</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">remove</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.parentNode.removeChild</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setAttributes</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">B</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">A</span><span class="PUNC">[</span><span class="NAME">B</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">bkLib</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">isMSIE</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">navigator.appVersion.indexOf</span><span class="PUNC">(</span><span class="STRN">"MSIE"</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">addEvent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">(</span><span class="NAME">C.addEventListener</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">C.addEventListener</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">,</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">C.attachEvent</span><span class="PUNC">(</span><span class="STRN">"on"</span><span class="PUNC">+</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">toArray</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">C.length</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">while</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">--</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">A</span><span class="PUNC">[</span><span class="NAME">B</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">C</span><span class="PUNC">[</span><span class="NAME">B</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">noSelect</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">B.setAttribute</span><span class="PUNC">&&</span><span class="NAME">B.nodeName.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="STRN">"input"</span><span class="PUNC">&&</span><span class="NAME">B.nodeName.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="STRN">"textarea"</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">B.setAttribute</span><span class="PUNC">(</span><span class="STRN">"unselectable"</span><span class="PUNC">,</span><span class="STRN">"on"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">&lt;</span><span class="NAME">B.childNodes.length</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">bkLib.noSelect</span><span class="PUNC">(</span><span class="NAME">B.childNodes</span><span class="PUNC">[</span><span class="NAME">A</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">camelize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">A.replace</span><span class="PUNC">(</span><span class="REGX">/\-(.)/g</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">C.toUpperCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">inArray</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">bkLib.search</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">search</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">B</span><span class="PUNC">&lt;</span><span class="NAME">A.length</span><span class="PUNC">;</span><span class="NAME">B</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">[</span><span class="NAME">B</span><span class="PUNC">]</span><span class="PUNC">==</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">cancelEvent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">A</span><span class="PUNC">||</span><span class="NAME">window.event</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">A.preventDefault</span><span class="PUNC">&&</span><span class="NAME">A.stopPropagation</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">A.preventDefault</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">A.stopPropagation</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">domLoad</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">domLoaded</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">arguments.callee.done</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="NAME">arguments.callee.done</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">bkLib.domLoad.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">bkLib.domLoad</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">onDomLoaded</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.domLoad.push</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">document.addEventListener</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">document.addEventListener</span><span class="PUNC">(</span><span class="STRN">"DOMContentLoaded"</span><span class="PUNC">,</span><span class="NAME">bkLib.domLoaded</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">bkLib.isMSIE</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">document.write</span><span class="PUNC">(</span><span class="STRN">"&lt;style>.nicEdit-main p { margin: 0; }&lt;/style>&lt;script id=__ie_onload defer "</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">location.protocol</span><span class="PUNC">==</span><span class="STRN">"https:"</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="STRN">"src='javascript:void(0)'"</span><span class="PUNC">:</span><span class="STRN">"src=//0"</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">">&lt;\/script>"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">$BK</span><span class="PUNC">(</span><span class="STRN">"__ie_onload"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">onreadystatechange</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.readyState</span><span class="PUNC">==</span><span class="STRN">"complete"</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">bkLib.domLoaded</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">window.onload</span><span class="PUNC">=</span><span class="NAME">bkLib.domLoaded</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">$BK</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">A.appendTo</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">bkExtend</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NAME">bkElement.prototype</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">A</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">bkEvent</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">addEvent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.eventList</span><span class="PUNC">=</span><span class="NAME">this.eventList</span><span class="PUNC">||</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.eventList</span><span class="PUNC">[</span><span class="NAME">A</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">this.eventList</span><span class="PUNC">[</span><span class="NAME">A</span><span class="PUNC">]</span><span class="PUNC">||</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.eventList</span><span class="PUNC">[</span><span class="NAME">A</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">push</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">fireEvent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">bkLib.toArray</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">A.shift</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.eventList</span><span class="PUNC">&&</span><span class="NAME">this.eventList</span><span class="PUNC">[</span><span class="NAME">C</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">B</span><span class="PUNC">&lt;</span><span class="NAME">this.eventList</span><span class="PUNC">[</span><span class="NAME">C</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">length</span><span class="PUNC">;</span><span class="NAME">B</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.eventList</span><span class="PUNC">[</span><span class="NAME">C</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">B</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">__</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">}</span><span class="NAME">Function.prototype.closure</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">bkLib.toArray</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">B.shift</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">bkLib</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="STRN">"undefined"</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">A.apply</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">,</span><span class="NAME">B.concat</span><span class="PUNC">(</span><span class="NAME">bkLib.toArray</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Function.prototype.closureListener</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">bkLib.toArray</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">C.shift</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">E</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NAME">E</span><span class="PUNC">||</span><span class="NAME">window.event</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">E.target</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">E.target</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">E.srcElement</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">A.apply</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">E</span><span class="PUNC">,</span><span class="NAME">D</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">concat</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 10</span> 
<span class='line'> 11</span> 
<span class='line'> 12</span> 
<span class='line'> 13</span> 
<span class='line'> 14</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nicEditorConfig</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">bkClass.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 15</span> </span><span class="WHIT">	</span><span class="NAME">buttons</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 16</span> </span><span class="WHIT">		</span><span class="STRN">'bold'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">__</span><span class="PUNC">(</span><span class="STRN">'Click to Bold'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">command</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'Bold'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tags</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="STRN">'B'</span><span class="PUNC">,</span><span class="STRN">'STRONG'</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">css</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="STRN">'font-weight'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'bold'</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'b'</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 17</span> </span><span class="WHIT">		</span><span class="STRN">'italic'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">__</span><span class="PUNC">(</span><span class="STRN">'Click to Italic'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">command</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'Italic'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tags</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="STRN">'EM'</span><span class="PUNC">,</span><span class="STRN">'I'</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">css</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="STRN">'font-style'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'italic'</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'i'</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 18</span> </span><span class="WHIT">		</span><span class="STRN">'underline'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">__</span><span class="PUNC">(</span><span class="STRN">'Click to Underline'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">command</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'Underline'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tags</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="STRN">'U'</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">css</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="STRN">'text-decoration'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'underline'</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'u'</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 19</span> </span><span class="WHIT">		</span><span class="STRN">'left'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">__</span><span class="PUNC">(</span><span class="STRN">'Left Align'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">command</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'justifyleft'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">noActive</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 20</span> </span><span class="WHIT">		</span><span class="STRN">'center'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">__</span><span class="PUNC">(</span><span class="STRN">'Center Align'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">command</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'justifycenter'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">noActive</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 21</span> </span><span class="WHIT">		</span><span class="STRN">'right'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">__</span><span class="PUNC">(</span><span class="STRN">'Right Align'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">command</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'justifyright'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">noActive</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 22</span> </span><span class="WHIT">		</span><span class="STRN">'justify'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">__</span><span class="PUNC">(</span><span class="STRN">'Justify Align'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">command</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'justifyfull'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">noActive</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 23</span> </span><span class="WHIT">		</span><span class="STRN">'ol'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">__</span><span class="PUNC">(</span><span class="STRN">'Insert Ordered List'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">command</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'insertorderedlist'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tags</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="STRN">'OL'</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 24</span> </span><span class="WHIT">		</span><span class="STRN">'ul'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> 	</span><span class="PUNC">{</span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">__</span><span class="PUNC">(</span><span class="STRN">'Insert Unordered List'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">command</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'insertunorderedlist'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tags</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="STRN">'UL'</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 25</span> </span><span class="WHIT">		</span><span class="STRN">'subscript'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">__</span><span class="PUNC">(</span><span class="STRN">'Click to Subscript'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">command</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'subscript'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tags</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="STRN">'SUB'</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 26</span> </span><span class="WHIT">		</span><span class="STRN">'superscript'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">__</span><span class="PUNC">(</span><span class="STRN">'Click to Superscript'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">command</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'superscript'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tags</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="STRN">'SUP'</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 27</span> </span><span class="WHIT">		</span><span class="STRN">'strikethrough'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">__</span><span class="PUNC">(</span><span class="STRN">'Click to Strike Through'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">command</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'strikeThrough'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">css</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="STRN">'text-decoration'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'line-through'</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 28</span> </span><span class="WHIT">		</span><span class="STRN">'indent'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">__</span><span class="PUNC">(</span><span class="STRN">'Indent Text'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">command</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'indent'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">noActive</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 29</span> </span><span class="WHIT">		</span><span class="STRN">'outdent'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">__</span><span class="PUNC">(</span><span class="STRN">'Remove Indent'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">command</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'outdent'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">noActive</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 30</span> </span><span class="WHIT">		</span><span class="STRN">'hr'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">__</span><span class="PUNC">(</span><span class="STRN">'Horizontal Rule'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">command</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'insertHorizontalRule'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">noActive</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 31</span> </span><span class="WHIT">		</span><span class="STRN">'removeformat'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">__</span><span class="PUNC">(</span><span class="STRN">'Remove Formatting'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">command</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'removeformat'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">noActive</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 32</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 33</span> </span><span class="WHIT">	</span><span class="NAME">iconsPath</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'../nicEditorIcons.gif'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 34</span> </span><span class="WHIT">	</span><span class="NAME">buttonList</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="STRN">'save'</span><span class="PUNC">,</span><span class="STRN">'bold'</span><span class="PUNC">,</span><span class="STRN">'italic'</span><span class="PUNC">,</span><span class="STRN">'underline'</span><span class="PUNC">,</span><span class="STRN">'left'</span><span class="PUNC">,</span><span class="STRN">'center'</span><span class="PUNC">,</span><span class="STRN">'right'</span><span class="PUNC">,</span><span class="STRN">'justify'</span><span class="PUNC">,</span><span class="STRN">'ol'</span><span class="PUNC">,</span><span class="STRN">'ul'</span><span class="PUNC">,</span><span class="STRN">'fontSize'</span><span class="PUNC">,</span><span class="STRN">'fontFamily'</span><span class="PUNC">,</span><span class="STRN">'fontFormat'</span><span class="PUNC">,</span><span class="STRN">'indent'</span><span class="PUNC">,</span><span class="STRN">'outdent'</span><span class="PUNC">,</span><span class="STRN">'link'</span><span class="PUNC">,</span><span class="STRN">'image'</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 35</span> </span><span class="WHIT">	</span><span class="NAME">iconList</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="STRN">"bgcolor"</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="STRN">"forecolor"</span><span class="PUNC">:</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="STRN">"bold"</span><span class="PUNC">:</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="STRN">"center"</span><span class="PUNC">:</span><span class="NUMB">4</span><span class="PUNC">,</span><span class="STRN">"hr"</span><span class="PUNC">:</span><span class="NUMB">5</span><span class="PUNC">,</span><span class="STRN">"indent"</span><span class="PUNC">:</span><span class="NUMB">6</span><span class="PUNC">,</span><span class="STRN">"italic"</span><span class="PUNC">:</span><span class="NUMB">7</span><span class="PUNC">,</span><span class="STRN">"justify"</span><span class="PUNC">:</span><span class="NUMB">8</span><span class="PUNC">,</span><span class="STRN">"left"</span><span class="PUNC">:</span><span class="NUMB">9</span><span class="PUNC">,</span><span class="STRN">"ol"</span><span class="PUNC">:</span><span class="NUMB">10</span><span class="PUNC">,</span><span class="STRN">"outdent"</span><span class="PUNC">:</span><span class="NUMB">11</span><span class="PUNC">,</span><span class="STRN">"right"</span><span class="PUNC">:</span><span class="NUMB">12</span><span class="PUNC">,</span><span class="STRN">"save"</span><span class="PUNC">:</span><span class="NUMB">23</span><span class="PUNC">,</span><span class="STRN">"strikethrough"</span><span class="PUNC">:</span><span class="NUMB">14</span><span class="PUNC">,</span><span class="STRN">"subscript"</span><span class="PUNC">:</span><span class="NUMB">15</span><span class="PUNC">,</span><span class="STRN">"superscript"</span><span class="PUNC">:</span><span class="NUMB">16</span><span class="PUNC">,</span><span class="STRN">"ul"</span><span class="PUNC">:</span><span class="NUMB">17</span><span class="PUNC">,</span><span class="STRN">"underline"</span><span class="PUNC">:</span><span class="NUMB">18</span><span class="PUNC">,</span><span class="STRN">"image"</span><span class="PUNC">:</span><span class="NUMB">19</span><span class="PUNC">,</span><span class="STRN">"link"</span><span class="PUNC">:</span><span class="NUMB">20</span><span class="PUNC">,</span><span class="STRN">"unlink"</span><span class="PUNC">:</span><span class="NUMB">21</span><span class="PUNC">,</span><span class="STRN">"close"</span><span class="PUNC">:</span><span class="NUMB">22</span><span class="PUNC">,</span><span class="STRN">"arrow"</span><span class="PUNC">:</span><span class="NUMB">24</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"removeformat"</span><span class="PUNC">:</span><span class="NUMB">26</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"xhtml"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">25</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 36</span> </span><span class="WHIT">	
<span class='line'> 37</span> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 38</span> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 39</span> 
<span class='line'> 40</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nicEditors</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">nicPlugins</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">editors</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">registerPlugin</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.nicPlugins.push</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">p</span><span class="PUNC">:</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">:</span><span class="NAME">A</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">allTextAreas</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">document.getElementsByTagName</span><span class="PUNC">(</span><span class="STRN">"textarea"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">B</span><span class="PUNC">&lt;</span><span class="NAME">A.length</span><span class="PUNC">;</span><span class="NAME">B</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">nicEditors.editors.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">nicEditor</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">panelInstance</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">[</span><span class="NAME">B</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">nicEditors.editors</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">findEditor</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">nicEditors.editors</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">&lt;</span><span class="NAME">B.length</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">[</span><span class="NAME">A</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">instanceById</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">[</span><span class="NAME">A</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">instanceById</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nicEditor</span><span class="PUNC">=</span><span class="NAME">bkClass.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">construct</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.options</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">nicEditorConfig</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">bkExtend</span><span class="PUNC">(</span><span class="NAME">this.options</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.nicInstances</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.loadedPlugins</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">nicEditors.nicPlugins</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">B</span><span class="PUNC">&lt;</span><span class="NAME">A.length</span><span class="PUNC">;</span><span class="NAME">B</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.loadedPlugins.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">[</span><span class="NAME">B</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">p</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">[</span><span class="NAME">B</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">nicEditors.editors.push</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">bkLib.addEvent</span><span class="PUNC">(</span><span class="NAME">document.body</span><span class="PUNC">,</span><span class="STRN">"mousedown"</span><span class="PUNC">,</span><span class="NAME">this.selectCheck.closureListener</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">panelInstance</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">this.checkReplace</span><span class="PUNC">(</span><span class="NAME">$BK</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">bkElement</span><span class="PUNC">(</span><span class="STRN">"DIV"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">width</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">B.getStyle</span><span class="PUNC">(</span><span class="STRN">"width"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">B.clientWidth</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">appendBefore</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.setPanel</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.addInstance</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">checkReplace</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">nicEditors.findEditor</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">A.removeInstance</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">A.removePanel</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">addInstance</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">this.checkReplace</span><span class="PUNC">(</span><span class="NAME">$BK</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">B.contentEditable</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">window.opera</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">navigator.userAgent.indexOf</span><span class="PUNC">(</span><span class="STRN">"Firefox/3"</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">nicEditorInstance</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">nicEditorIFrameInstance</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.nicInstances.push</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">removeInstance</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">$BK</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">this.nicInstances</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">&lt;</span><span class="NAME">B.length</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">[</span><span class="NAME">A</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">e</span><span class="PUNC">==</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">B</span><span class="PUNC">[</span><span class="NAME">A</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">remove</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.nicInstances.splice</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">removePanel</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.nicPanel</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.nicPanel.remove</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.nicPanel</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">instanceById</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">$BK</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">this.nicInstances</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">&lt;</span><span class="NAME">B.length</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">[</span><span class="NAME">A</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">e</span><span class="PUNC">==</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">[</span><span class="NAME">A</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setPanel</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.nicPanel</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">nicEditorPanel</span><span class="PUNC">(</span><span class="NAME">$BK</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.options</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.fireEvent</span><span class="PUNC">(</span><span class="STRN">"panel"</span><span class="PUNC">,</span><span class="NAME">this.nicPanel</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">nicCommand</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.selectedInstance</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.selectedInstance.nicCommand</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getIcon</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">this.options.iconList</span><span class="PUNC">[</span><span class="NAME">D</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">A.iconFiles</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">A.iconFiles</span><span class="PUNC">[</span><span class="NAME">D</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">{</span><span class="NAME">backgroundImage</span><span class="PUNC">:</span><span class="STRN">"url('"</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">this.options.iconsPath</span><span class="PUNC">:</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"')"</span><span class="PUNC">,</span><span class="NAME">backgroundPosition</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">-</span><span class="NUMB">18</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"px 0px"</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">selectCheck</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="KEYW">do</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">A.className</span><span class="PUNC">&&</span><span class="NAME">A.className.indexOf</span><span class="PUNC">(</span><span class="STRN">"nicEdit"</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">while</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">A.parentNode</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.fireEvent</span><span class="PUNC">(</span><span class="STRN">"blur"</span><span class="PUNC">,</span><span class="NAME">this.selectedInstance</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.lastSelectedInstance</span><span class="PUNC">=</span><span class="NAME">this.selectedInstance</span><span class="PUNC">;</span><span class="NAME">this.selectedInstance</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">nicEditor</span><span class="PUNC">=</span><span class="NAME">nicEditor.extend</span><span class="PUNC">(</span><span class="NAME">bkEvent</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 41</span> 
<span class='line'> 42</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nicEditorInstance</span><span class="PUNC">=</span><span class="NAME">bkClass.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">isSelected</span><span class="PUNC">:</span><span class="KEYW">false</span><span class="PUNC">,</span><span class="NAME">construct</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">F</span><span class="PUNC">,</span><span class="NAME">D</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.ne</span><span class="PUNC">=</span><span class="NAME">C</span><span class="PUNC">;</span><span class="NAME">this.elm</span><span class="PUNC">=</span><span class="NAME">this.e</span><span class="PUNC">=</span><span class="NAME">F</span><span class="PUNC">;</span><span class="NAME">this.options</span><span class="PUNC">=</span><span class="NAME">D</span><span class="PUNC">||</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">newX</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">F.getStyle</span><span class="PUNC">(</span><span class="STRN">"width"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">F.clientWidth</span><span class="PUNC">;</span><span class="NAME">newY</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">F.getStyle</span><span class="PUNC">(</span><span class="STRN">"height"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">F.clientHeight</span><span class="PUNC">;</span><span class="NAME">this.initialHeight</span><span class="PUNC">=</span><span class="NAME">newY</span><span class="PUNC">-</span><span class="NUMB">8</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">G</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">F.nodeName.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="STRN">"textarea"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">||</span><span class="NAME">this.options.hasPanel</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.editorContain</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">bkElement</span><span class="PUNC">(</span><span class="STRN">"DIV"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">width</span><span class="PUNC">:</span><span class="NAME">newX</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">,</span><span class="NAME">border</span><span class="PUNC">:</span><span class="STRN">"1px solid #ccc"</span><span class="PUNC">,</span><span class="NAME">borderTop</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">overflowY</span><span class="PUNC">:</span><span class="STRN">"auto"</span><span class="PUNC">,</span><span class="NAME">overflowX</span><span class="PUNC">:</span><span class="STRN">"hidden"</span><span class="PUNC">,</span><span class="NAME">maxHeight</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">this.ne.options.maxHeight</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">this.ne.options.maxHeight</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">appendBefore</span><span class="PUNC">(</span><span class="NAME">F</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">bkElement</span><span class="PUNC">(</span><span class="STRN">"DIV"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">width</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">newX</span><span class="PUNC">-</span><span class="NUMB">8</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">,</span><span class="NAME">margin</span><span class="PUNC">:</span><span class="STRN">"4px"</span><span class="PUNC">,</span><span class="NAME">minHeight</span><span class="PUNC">:</span><span class="NAME">newY</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">"main"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">appendTo</span><span class="PUNC">(</span><span class="NAME">this.editorContain</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">F.setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">display</span><span class="PUNC">:</span><span class="STRN">"none"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">A.innerHTML</span><span class="PUNC">=</span><span class="NAME">F.innerHTML</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">A.setContent</span><span class="PUNC">(</span><span class="NAME">F.value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.copyElm</span><span class="PUNC">=</span><span class="NAME">F</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">E</span><span class="PUNC">=</span><span class="NAME">F.parentTag</span><span class="PUNC">(</span><span class="STRN">"FORM"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">E</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">bkLib.addEvent</span><span class="PUNC">(</span><span class="NAME">E</span><span class="PUNC">,</span><span class="STRN">"submit"</span><span class="PUNC">,</span><span class="NAME">this.saveContent.closure</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">bkLib.isMSIE</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">document.body.style.maxHeight</span><span class="PUNC">!=</span><span class="STRN">"undefined"</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">document.compatMode</span><span class="PUNC">==</span><span class="STRN">"CSS1Compat"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">A.setStyle</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="PUNC">{</span><span class="NAME">height</span><span class="PUNC">:</span><span class="NAME">newY</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">}</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">overflow</span><span class="PUNC">:</span><span class="STRN">"hidden"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.elm</span><span class="PUNC">=</span><span class="NAME">A</span><span class="PUNC">}</span><span class="NAME">this.ne.addEvent</span><span class="PUNC">(</span><span class="STRN">"blur"</span><span class="PUNC">,</span><span class="NAME">this.blur.closure</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.init</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.blur</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="NAME">this.nicCommand</span><span class="PUNC">(</span><span class="STRN">"styleWithCSS"</span><span class="PUNC">,</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">F</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">init</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.elm.setAttribute</span><span class="PUNC">(</span><span class="STRN">"contentEditable"</span><span class="PUNC">,</span><span class="STRN">"true"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.getContent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.setContent</span><span class="PUNC">(</span><span class="STRN">"&lt;br />"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.instanceDoc</span><span class="PUNC">=</span><span class="NAME">document.defaultView</span><span class="PUNC">;</span><span class="NAME">this.elm.addEvent</span><span class="PUNC">(</span><span class="STRN">"mousedown"</span><span class="PUNC">,</span><span class="NAME">this.selected.closureListener</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addEvent</span><span class="PUNC">(</span><span class="STRN">"keypress"</span><span class="PUNC">,</span><span class="NAME">this.keyDown.closureListener</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addEvent</span><span class="PUNC">(</span><span class="STRN">"focus"</span><span class="PUNC">,</span><span class="NAME">this.selected.closure</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addEvent</span><span class="PUNC">(</span><span class="STRN">"blur"</span><span class="PUNC">,</span><span class="NAME">this.blur.closure</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addEvent</span><span class="PUNC">(</span><span class="STRN">"keyup"</span><span class="PUNC">,</span><span class="NAME">this.selected.closure</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.ne.fireEvent</span><span class="PUNC">(</span><span class="STRN">"add"</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">remove</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.saveContent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.copyElm</span><span class="PUNC">||</span><span class="NAME">this.options.hasPanel</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.editorContain.remove</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.e.setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">display</span><span class="PUNC">:</span><span class="STRN">"block"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.ne.removePanel</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.disable</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.ne.fireEvent</span><span class="PUNC">(</span><span class="STRN">"remove"</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">disable</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.elm.setAttribute</span><span class="PUNC">(</span><span class="STRN">"contentEditable"</span><span class="PUNC">,</span><span class="STRN">"false"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getSel</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">window.getSelection</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">window.getSelection</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">document.selection</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getRng</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">this.getSel</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">A.rangeCount</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">A.getRangeAt</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">A.createRange</span><span class="PUNC">&&</span><span class="NAME">A.createRange</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">document.createRange</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">selRng</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">window.getSelection</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">B.removeAllRanges</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">B.addRange</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">A.select</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">selElm</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">this.getRng</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">C.startContainer</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">C.startContainer</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">C.cloneContents</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">childNodes.length</span><span class="PUNC">==</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">B</span><span class="PUNC">&lt;</span><span class="NAME">D.childNodes.length</span><span class="PUNC">;</span><span class="NAME">B</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">D.childNodes</span><span class="PUNC">[</span><span class="NAME">B</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">ownerDocument.createRange</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">A.selectNode</span><span class="PUNC">(</span><span class="NAME">D.childNodes</span><span class="PUNC">[</span><span class="NAME">B</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">C.compareBoundaryPoints</span><span class="PUNC">(</span><span class="NAME">Range.START_TO_START</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="NUMB">1</span><span class="PUNC">&&</span><span class="NAME">C.compareBoundaryPoints</span><span class="PUNC">(</span><span class="NAME">Range.END_TO_END</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">$BK</span><span class="PUNC">(</span><span class="NAME">D.childNodes</span><span class="PUNC">[</span><span class="NAME">B</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">$BK</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">$BK</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">this.getSel</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">type</span><span class="PUNC">==</span><span class="STRN">"Control"</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">C.item</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">C.parentElement</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">saveRng</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.savedRange</span><span class="PUNC">=</span><span class="NAME">this.getRng</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.savedSel</span><span class="PUNC">=</span><span class="NAME">this.getSel</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">restoreRng</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.savedRange</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.selRng</span><span class="PUNC">(</span><span class="NAME">this.savedRange</span><span class="PUNC">,</span><span class="NAME">this.savedSel</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">keyDown</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">B.ctrlKey</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.ne.fireEvent</span><span class="PUNC">(</span><span class="STRN">"key"</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">selected</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">this.selElm</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">C.ctrlKey</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">this.ne.selectedInstance</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">!=</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.ne.fireEvent</span><span class="PUNC">(</span><span class="STRN">"blur"</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.ne.selectedInstance</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="NAME">this.ne.fireEvent</span><span class="PUNC">(</span><span class="STRN">"focus"</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.ne.fireEvent</span><span class="PUNC">(</span><span class="STRN">"selected"</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.isFocused</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">;</span><span class="NAME">this.elm.addClass</span><span class="PUNC">(</span><span class="STRN">"selected"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">blur</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.isFocused</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="NAME">this.elm.removeClass</span><span class="PUNC">(</span><span class="STRN">"selected"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">saveContent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.copyElm</span><span class="PUNC">||</span><span class="NAME">this.options.hasPanel</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.ne.fireEvent</span><span class="PUNC">(</span><span class="STRN">"save"</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">(</span><span class="NAME">this.copyElm</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">this.copyElm.value</span><span class="PUNC">=</span><span class="NAME">this.getContent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.e.innerHTML</span><span class="PUNC">=</span><span class="NAME">this.getContent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getElm</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.elm</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getContent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.content</span><span class="PUNC">=</span><span class="NAME">this.getElm</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">innerHTML</span><span class="PUNC">;</span><span class="NAME">this.ne.fireEvent</span><span class="PUNC">(</span><span class="STRN">"get"</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.content</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setContent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.content</span><span class="PUNC">=</span><span class="NAME">A</span><span class="PUNC">;</span><span class="NAME">this.ne.fireEvent</span><span class="PUNC">(</span><span class="STRN">"set"</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.elm.innerHTML</span><span class="PUNC">=</span><span class="NAME">this.content</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">nicCommand</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">document.execCommand</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">,</span><span class="KEYW">false</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 43</span> 
<span class='line'> 44</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nicEditorIFrameInstance</span><span class="PUNC">=</span><span class="NAME">nicEditorInstance.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">savedStyles</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">init</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">this.elm.innerHTML.replace</span><span class="PUNC">(</span><span class="REGX">/^\s+|\s+$/g</span><span class="PUNC">,</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.elm.innerHTML</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">;</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">B</span><span class="PUNC">=</span><span class="STRN">"&lt;br />"</span><span class="PUNC">:</span><span class="NAME">B</span><span class="PUNC">;</span><span class="NAME">this.initialContent</span><span class="PUNC">=</span><span class="NAME">B</span><span class="PUNC">;</span><span class="NAME">this.elmFrame</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">bkElement</span><span class="PUNC">(</span><span class="STRN">"iframe"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setAttributes</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">src</span><span class="PUNC">:</span><span class="STRN">"javascript:;"</span><span class="PUNC">,</span><span class="NAME">frameBorder</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">allowTransparency</span><span class="PUNC">:</span><span class="STRN">"true"</span><span class="PUNC">,</span><span class="NAME">scrolling</span><span class="PUNC">:</span><span class="STRN">"no"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">height</span><span class="PUNC">:</span><span class="STRN">"100px"</span><span class="PUNC">,</span><span class="NAME">width</span><span class="PUNC">:</span><span class="STRN">"100%"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">"frame"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">appendTo</span><span class="PUNC">(</span><span class="NAME">this.elm</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.copyElm</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.elmFrame.setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">width</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">this.elm.offsetWidth</span><span class="PUNC">-</span><span class="NUMB">4</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="STRN">"font-size"</span><span class="PUNC">,</span><span class="STRN">"font-family"</span><span class="PUNC">,</span><span class="STRN">"font-weight"</span><span class="PUNC">,</span><span class="STRN">"color"</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">itm</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.savedStyles</span><span class="PUNC">[</span><span class="NAME">bkLib.camelize</span><span class="PUNC">(</span><span class="NAME">itm</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">this.elm.getStyle</span><span class="PUNC">(</span><span class="NAME">itm</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">setTimeout</span><span class="PUNC">(</span><span class="NAME">this.initFrame.closure</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">50</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">disable</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.elm.innerHTML</span><span class="PUNC">=</span><span class="NAME">this.getContent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">initFrame</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">$BK</span><span class="PUNC">(</span><span class="NAME">this.elmFrame.contentWindow.document</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">B.designMode</span><span class="PUNC">=</span><span class="STRN">"on"</span><span class="PUNC">;</span><span class="NAME">B.open</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">this.ne.options.externalCSS</span><span class="PUNC">;</span><span class="NAME">B.write</span><span class="PUNC">(</span><span class="STRN">"&lt;html>&lt;head>"</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="STRN">'&lt;link href="'</span><span class="PUNC">+</span><span class="NAME">A</span><span class="PUNC">+</span><span class="STRN">'" rel="stylesheet" type="text/css" />'</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">'&lt;/head>&lt;body id="nicEditContent" style="margin: 0 !important; background-color: transparent !important;">'</span><span class="PUNC">+</span><span class="NAME">this.initialContent</span><span class="PUNC">+</span><span class="STRN">"&lt;/body>&lt;/html>"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">B.close</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.frameDoc</span><span class="PUNC">=</span><span class="NAME">B</span><span class="PUNC">;</span><span class="NAME">this.frameWin</span><span class="PUNC">=</span><span class="NAME">$BK</span><span class="PUNC">(</span><span class="NAME">this.elmFrame.contentWindow</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.frameContent</span><span class="PUNC">=</span><span class="NAME">$BK</span><span class="PUNC">(</span><span class="NAME">this.frameWin.document.body</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="NAME">this.savedStyles</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.instanceDoc</span><span class="PUNC">=</span><span class="NAME">this.frameWin.document.defaultView</span><span class="PUNC">;</span><span class="NAME">this.heightUpdate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.frameDoc.addEvent</span><span class="PUNC">(</span><span class="STRN">"mousedown"</span><span class="PUNC">,</span><span class="NAME">this.selected.closureListener</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addEvent</span><span class="PUNC">(</span><span class="STRN">"keyup"</span><span class="PUNC">,</span><span class="NAME">this.heightUpdate.closureListener</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addEvent</span><span class="PUNC">(</span><span class="STRN">"keydown"</span><span class="PUNC">,</span><span class="NAME">this.keyDown.closureListener</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addEvent</span><span class="PUNC">(</span><span class="STRN">"keyup"</span><span class="PUNC">,</span><span class="NAME">this.selected.closure</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.ne.fireEvent</span><span class="PUNC">(</span><span class="STRN">"add"</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getElm</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.frameContent</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setContent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.content</span><span class="PUNC">=</span><span class="NAME">A</span><span class="PUNC">;</span><span class="NAME">this.ne.fireEvent</span><span class="PUNC">(</span><span class="STRN">"set"</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.frameContent.innerHTML</span><span class="PUNC">=</span><span class="NAME">this.content</span><span class="PUNC">;</span><span class="NAME">this.heightUpdate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getSel</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">this.frameWin</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">this.frameWin.getSelection</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.frameDoc.selection</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">heightUpdate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.elmFrame.style.height</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">this.frameContent.offsetHeight</span><span class="PUNC">,</span><span class="NAME">this.initialHeight</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">nicCommand</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.frameDoc.execCommand</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">,</span><span class="KEYW">false</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">setTimeout</span><span class="PUNC">(</span><span class="NAME">this.heightUpdate.closure</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">100</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 45</span> 
<span class='line'> 46</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nicEditorPanel</span><span class="PUNC">=</span><span class="NAME">bkClass.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">construct</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">E</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.elm</span><span class="PUNC">=</span><span class="NAME">E</span><span class="PUNC">;</span><span class="NAME">this.options</span><span class="PUNC">=</span><span class="NAME">B</span><span class="PUNC">;</span><span class="NAME">this.ne</span><span class="PUNC">=</span><span class="NAME">A</span><span class="PUNC">;</span><span class="NAME">this.panelButtons</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.buttonList</span><span class="PUNC">=</span><span class="NAME">bkExtend</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">this.ne.options.buttonList</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.panelContain</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">bkElement</span><span class="PUNC">(</span><span class="STRN">"DIV"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">overflow</span><span class="PUNC">:</span><span class="STRN">"hidden"</span><span class="PUNC">,</span><span class="NAME">width</span><span class="PUNC">:</span><span class="STRN">"100%"</span><span class="PUNC">,</span><span class="NAME">border</span><span class="PUNC">:</span><span class="STRN">"1px solid #cccccc"</span><span class="PUNC">,</span><span class="NAME">backgroundColor</span><span class="PUNC">:</span><span class="STRN">"#efefef"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">"panelContain"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.panelElm</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">bkElement</span><span class="PUNC">(</span><span class="STRN">"DIV"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">margin</span><span class="PUNC">:</span><span class="STRN">"2px"</span><span class="PUNC">,</span><span class="NAME">marginTop</span><span class="PUNC">:</span><span class="STRN">"0px"</span><span class="PUNC">,</span><span class="NAME">zoom</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">overflow</span><span class="PUNC">:</span><span class="STRN">"hidden"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">"panel"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">appendTo</span><span class="PUNC">(</span><span class="NAME">this.panelContain</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.panelContain.appendTo</span><span class="PUNC">(</span><span class="NAME">E</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">this.ne.options</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">C.buttons</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">button</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">D</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.addButton</span><span class="PUNC">(</span><span class="NAME">button</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">,</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.reorder</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">E.noSelect</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">addButton</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">buttonName</span><span class="PUNC">,</span><span class="NAME">options</span><span class="PUNC">,</span><span class="NAME">noOrder</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">button</span><span class="PUNC">=</span><span class="NAME">options.buttons</span><span class="PUNC">[</span><span class="NAME">buttonName</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">type</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">button.type</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">eval</span><span class="PUNC">(</span><span class="STRN">"(typeof("</span><span class="PUNC">+</span><span class="NAME">button.type</span><span class="PUNC">+</span><span class="STRN">') == "undefined") ? null : '</span><span class="PUNC">+</span><span class="NAME">button.type</span><span class="PUNC">+</span><span class="STRN">";"</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">nicEditorButton</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">hasButton</span><span class="PUNC">=</span><span class="NAME">bkLib.inArray</span><span class="PUNC">(</span><span class="NAME">this.buttonList</span><span class="PUNC">,</span><span class="NAME">buttonName</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">type</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">hasButton</span><span class="PUNC">||</span><span class="NAME">this.ne.options.fullPanel</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.panelButtons.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">type</span><span class="PUNC">(</span><span class="NAME">this.panelElm</span><span class="PUNC">,</span><span class="NAME">buttonName</span><span class="PUNC">,</span><span class="NAME">options</span><span class="PUNC">,</span><span class="NAME">this.ne</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">hasButton</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.buttonList.push</span><span class="PUNC">(</span><span class="NAME">buttonName</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">findButton</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">&lt;</span><span class="NAME">this.panelButtons.length</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.panelButtons</span><span class="PUNC">[</span><span class="NAME">A</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">name</span><span class="PUNC">==</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.panelButtons</span><span class="PUNC">[</span><span class="NAME">A</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">reorder</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">this.buttonList</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">B</span><span class="PUNC">&lt;</span><span class="NAME">C.length</span><span class="PUNC">;</span><span class="NAME">B</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">this.findButton</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">[</span><span class="NAME">B</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.panelElm.appendChild</span><span class="PUNC">(</span><span class="NAME">A.margin</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">remove</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.elm.remove</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 47</span> 
<span class='line'> 48</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nicEditorButton</span><span class="PUNC">=</span><span class="NAME">bkClass.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">construct</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.options</span><span class="PUNC">=</span><span class="NAME">C.buttons</span><span class="PUNC">[</span><span class="NAME">A</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.name</span><span class="PUNC">=</span><span class="NAME">A</span><span class="PUNC">;</span><span class="NAME">this.ne</span><span class="PUNC">=</span><span class="NAME">B</span><span class="PUNC">;</span><span class="NAME">this.elm</span><span class="PUNC">=</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">this.margin</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">bkElement</span><span class="PUNC">(</span><span class="STRN">"DIV"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="STRN">"float"</span><span class="PUNC">:</span><span class="STRN">"left"</span><span class="PUNC">,</span><span class="NAME">marginTop</span><span class="PUNC">:</span><span class="STRN">"2px"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">appendTo</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.contain</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">bkElement</span><span class="PUNC">(</span><span class="STRN">"DIV"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">width</span><span class="PUNC">:</span><span class="STRN">"20px"</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">:</span><span class="STRN">"20px"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">"buttonContain"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">appendTo</span><span class="PUNC">(</span><span class="NAME">this.margin</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.border</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">bkElement</span><span class="PUNC">(</span><span class="STRN">"DIV"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">backgroundColor</span><span class="PUNC">:</span><span class="STRN">"#efefef"</span><span class="PUNC">,</span><span class="NAME">border</span><span class="PUNC">:</span><span class="STRN">"1px solid #efefef"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">appendTo</span><span class="PUNC">(</span><span class="NAME">this.contain</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.button</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">bkElement</span><span class="PUNC">(</span><span class="STRN">"DIV"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">width</span><span class="PUNC">:</span><span class="STRN">"18px"</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">:</span><span class="STRN">"18px"</span><span class="PUNC">,</span><span class="NAME">overflow</span><span class="PUNC">:</span><span class="STRN">"hidden"</span><span class="PUNC">,</span><span class="NAME">zoom</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">cursor</span><span class="PUNC">:</span><span class="STRN">"pointer"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">"button"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="NAME">this.ne.getIcon</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">appendTo</span><span class="PUNC">(</span><span class="NAME">this.border</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.button.addEvent</span><span class="PUNC">(</span><span class="STRN">"mouseover"</span><span class="PUNC">,</span><span class="NAME">this.hoverOn.closure</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addEvent</span><span class="PUNC">(</span><span class="STRN">"mouseout"</span><span class="PUNC">,</span><span class="NAME">this.hoverOff.closure</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addEvent</span><span class="PUNC">(</span><span class="STRN">"mousedown"</span><span class="PUNC">,</span><span class="NAME">this.mouseClick.closure</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">noSelect</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">window.opera</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.button.onmousedown</span><span class="PUNC">=</span><span class="NAME">this.button.onclick</span><span class="PUNC">=</span><span class="NAME">bkLib.cancelEvent</span><span class="PUNC">}</span><span class="NAME">B.addEvent</span><span class="PUNC">(</span><span class="STRN">"selected"</span><span class="PUNC">,</span><span class="NAME">this.enable.closure</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addEvent</span><span class="PUNC">(</span><span class="STRN">"blur"</span><span class="PUNC">,</span><span class="NAME">this.disable.closure</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addEvent</span><span class="PUNC">(</span><span class="STRN">"key"</span><span class="PUNC">,</span><span class="NAME">this.key.closure</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.disable</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.init</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">init</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">hide</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.contain.setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">display</span><span class="PUNC">:</span><span class="STRN">"none"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">updateState</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.isDisabled</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.setBg</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.isHover</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.setBg</span><span class="PUNC">(</span><span class="STRN">"hover"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.isActive</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.setBg</span><span class="PUNC">(</span><span class="STRN">"active"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">this.setBg</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setBg</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="STRN">"hover"</span><span class="PUNC">:</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">border</span><span class="PUNC">:</span><span class="STRN">"1px solid #666"</span><span class="PUNC">,</span><span class="NAME">backgroundColor</span><span class="PUNC">:</span><span class="STRN">"#ddd"</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="STRN">"active"</span><span class="PUNC">:</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">border</span><span class="PUNC">:</span><span class="STRN">"1px solid #666"</span><span class="PUNC">,</span><span class="NAME">backgroundColor</span><span class="PUNC">:</span><span class="STRN">"#ccc"</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">border</span><span class="PUNC">:</span><span class="STRN">"1px solid #efefef"</span><span class="PUNC">,</span><span class="NAME">backgroundColor</span><span class="PUNC">:</span><span class="STRN">"#efefef"</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">this.border.setStyle</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">"button-"</span><span class="PUNC">+</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">checkNodes</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">A</span><span class="PUNC">;</span><span class="KEYW">do</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.options.tags</span><span class="PUNC">&&</span><span class="NAME">bkLib.inArray</span><span class="PUNC">(</span><span class="NAME">this.options.tags</span><span class="PUNC">,</span><span class="NAME">B.nodeName</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.activate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">while</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">B.parentNode</span><span class="PUNC">&&</span><span class="NAME">B.className</span><span class="PUNC">!=</span><span class="STRN">"nicEdit"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">$BK</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">while</span><span class="PUNC">(</span><span class="NAME">B.nodeType</span><span class="PUNC">==</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">$BK</span><span class="PUNC">(</span><span class="NAME">B.parentNode</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.options.css</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">itm</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">this.options.css</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">B.getStyle</span><span class="PUNC">(</span><span class="NAME">itm</span><span class="PUNC">,</span><span class="NAME">this.ne.selectedInstance.instanceDoc</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">this.options.css</span><span class="PUNC">[</span><span class="NAME">itm</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.activate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">this.deactivate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">activate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.isDisabled</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.isActive</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">;</span><span class="NAME">this.updateState</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.ne.fireEvent</span><span class="PUNC">(</span><span class="STRN">"buttonActivate"</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">deactivate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.isActive</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="NAME">this.updateState</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.isDisabled</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.ne.fireEvent</span><span class="PUNC">(</span><span class="STRN">"buttonDeactivate"</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">enable</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.isDisabled</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="NAME">this.contain.setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">opacity</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">"buttonEnabled"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.updateState</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.checkNodes</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">disable</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.isDisabled</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">;</span><span class="NAME">this.contain.setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">opacity</span><span class="PUNC">:</span><span class="NUMB">0.6</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">removeClass</span><span class="PUNC">(</span><span class="STRN">"buttonEnabled"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.updateState</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">toggleActive</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">(</span><span class="NAME">this.isActive</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">this.deactivate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.activate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">hoverOn</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.isDisabled</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.isHover</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">;</span><span class="NAME">this.updateState</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.ne.fireEvent</span><span class="PUNC">(</span><span class="STRN">"buttonOver"</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">hoverOff</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.isHover</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="NAME">this.updateState</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.ne.fireEvent</span><span class="PUNC">(</span><span class="STRN">"buttonOut"</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">mouseClick</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.options.command</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.ne.nicCommand</span><span class="PUNC">(</span><span class="NAME">this.options.command</span><span class="PUNC">,</span><span class="NAME">this.options.commandArgs</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.options.noActive</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.toggleActive</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">this.ne.fireEvent</span><span class="PUNC">(</span><span class="STRN">"buttonClick"</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">key</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.options.key</span><span class="PUNC">&&</span><span class="NAME">B.ctrlKey</span><span class="PUNC">&&</span><span class="NAME">String.fromCharCode</span><span class="PUNC">(</span><span class="NAME">B.keyCode</span><span class="PUNC">||</span><span class="NAME">B.charCode</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">this.options.key</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.mouseClick</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">B.preventDefault</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">B.preventDefault</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 49</span> 
<span class='line'> 50</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nicPlugin</span><span class="PUNC">=</span><span class="NAME">bkClass.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">construct</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.options</span><span class="PUNC">=</span><span class="NAME">A</span><span class="PUNC">;</span><span class="NAME">this.ne</span><span class="PUNC">=</span><span class="NAME">B</span><span class="PUNC">;</span><span class="NAME">this.ne.addEvent</span><span class="PUNC">(</span><span class="STRN">"panel"</span><span class="PUNC">,</span><span class="NAME">this.loadPanel.closure</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.init</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">loadPanel</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">this.options.buttons</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">A</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">C.addButton</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NAME">this.options</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">C.reorder</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">init</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 51</span> 
<span class='line'> 52</span> 
<span class='line'> 53</span> 
<span class='line'> 54</span> 
<span class='line'> 55</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nicPaneOptions</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 56</span> 
<span class='line'> 57</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nicEditorPane</span><span class="PUNC">=</span><span class="NAME">bkClass.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">construct</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.ne</span><span class="PUNC">=</span><span class="NAME">C</span><span class="PUNC">;</span><span class="NAME">this.elm</span><span class="PUNC">=</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">this.pos</span><span class="PUNC">=</span><span class="NAME">D.pos</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.contain</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">bkElement</span><span class="PUNC">(</span><span class="STRN">"div"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">zIndex</span><span class="PUNC">:</span><span class="STRN">"99999"</span><span class="PUNC">,</span><span class="NAME">overflow</span><span class="PUNC">:</span><span class="STRN">"hidden"</span><span class="PUNC">,</span><span class="NAME">position</span><span class="PUNC">:</span><span class="STRN">"absolute"</span><span class="PUNC">,</span><span class="NAME">left</span><span class="PUNC">:</span><span class="NAME">this.pos</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">,</span><span class="NAME">top</span><span class="PUNC">:</span><span class="NAME">this.pos</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.pane</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">bkElement</span><span class="PUNC">(</span><span class="STRN">"div"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">fontSize</span><span class="PUNC">:</span><span class="STRN">"12px"</span><span class="PUNC">,</span><span class="NAME">border</span><span class="PUNC">:</span><span class="STRN">"1px solid #ccc"</span><span class="PUNC">,</span><span class="NAME">overflow</span><span class="PUNC">:</span><span class="STRN">"hidden"</span><span class="PUNC">,</span><span class="NAME">padding</span><span class="PUNC">:</span><span class="STRN">"4px"</span><span class="PUNC">,</span><span class="NAME">textAlign</span><span class="PUNC">:</span><span class="STRN">"left"</span><span class="PUNC">,</span><span class="NAME">backgroundColor</span><span class="PUNC">:</span><span class="STRN">"#ffffc9"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">"pane"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">appendTo</span><span class="PUNC">(</span><span class="NAME">this.contain</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">A.options.noClose</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.close</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">bkElement</span><span class="PUNC">(</span><span class="STRN">"div"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="STRN">"float"</span><span class="PUNC">:</span><span class="STRN">"right"</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">:</span><span class="STRN">"16px"</span><span class="PUNC">,</span><span class="NAME">width</span><span class="PUNC">:</span><span class="STRN">"16px"</span><span class="PUNC">,</span><span class="NAME">cursor</span><span class="PUNC">:</span><span class="STRN">"pointer"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="NAME">this.ne.getIcon</span><span class="PUNC">(</span><span class="STRN">"close"</span><span class="PUNC">,</span><span class="NAME">nicPaneOptions</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addEvent</span><span class="PUNC">(</span><span class="STRN">"mousedown"</span><span class="PUNC">,</span><span class="NAME">A.removePane.closure</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">appendTo</span><span class="PUNC">(</span><span class="NAME">this.pane</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.contain.noSelect</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">appendTo</span><span class="PUNC">(</span><span class="NAME">document.body</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.position</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.init</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">init</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">position</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.ne.nicPanel</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">this.ne.nicPanel.elm</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">B.pos</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">A</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">B.getStyle</span><span class="PUNC">(</span><span class="STRN">"width"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this.pane.getStyle</span><span class="PUNC">(</span><span class="STRN">"width"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NUMB">8</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">&lt;</span><span class="NAME">this.pos</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.contain.setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">left</span><span class="PUNC">:</span><span class="NAME">C</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">toggle</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.isVisible</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NAME">this.isVisible</span><span class="PUNC">;</span><span class="NAME">this.contain.setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">display</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">this.isVisible</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="STRN">"block"</span><span class="PUNC">:</span><span class="STRN">"none"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">remove</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.contain</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.contain.remove</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.contain</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">append</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">A.appendTo</span><span class="PUNC">(</span><span class="NAME">this.pane</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setContent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.pane.setContent</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 58</span> 
<span class='line'> 59</span> 
<span class='line'> 60</span> 
<span class='line'> 61</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nicEditorAdvancedButton</span><span class="PUNC">=</span><span class="NAME">nicEditorButton.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.ne.addEvent</span><span class="PUNC">(</span><span class="STRN">"selected"</span><span class="PUNC">,</span><span class="NAME">this.removePane.closure</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addEvent</span><span class="PUNC">(</span><span class="STRN">"blur"</span><span class="PUNC">,</span><span class="NAME">this.removePane.closure</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">mouseClick</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.isDisabled</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.pane</span><span class="PUNC">&&</span><span class="NAME">this.pane.pane</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.removePane</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">this.pane</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">nicEditorPane</span><span class="PUNC">(</span><span class="NAME">this.contain</span><span class="PUNC">,</span><span class="NAME">this.ne</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">width</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">this.width</span><span class="PUNC">||</span><span class="STRN">"270px"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">backgroundColor</span><span class="PUNC">:</span><span class="STRN">"#fff"</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.addPane</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.ne.selectedInstance.saveRng</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">addForm</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.form</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">bkElement</span><span class="PUNC">(</span><span class="STRN">"form"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addEvent</span><span class="PUNC">(</span><span class="STRN">"submit"</span><span class="PUNC">,</span><span class="NAME">this.submit.closureListener</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.pane.append</span><span class="PUNC">(</span><span class="NAME">this.form</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.inputs</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">itm</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">C</span><span class="PUNC">[</span><span class="NAME">itm</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">F</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">G.getAttribute</span><span class="PUNC">(</span><span class="NAME">itm</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">F</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">D.value</span><span class="PUNC">||</span><span class="STRN">""</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">C</span><span class="PUNC">[</span><span class="NAME">itm</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">type</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">==</span><span class="STRN">"title"</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">bkElement</span><span class="PUNC">(</span><span class="STRN">"div"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setContent</span><span class="PUNC">(</span><span class="NAME">D.txt</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">fontSize</span><span class="PUNC">:</span><span class="STRN">"14px"</span><span class="PUNC">,</span><span class="NAME">fontWeight</span><span class="PUNC">:</span><span class="STRN">"bold"</span><span class="PUNC">,</span><span class="NAME">padding</span><span class="PUNC">:</span><span class="STRN">"0px"</span><span class="PUNC">,</span><span class="NAME">margin</span><span class="PUNC">:</span><span class="STRN">"2px 0"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">appendTo</span><span class="PUNC">(</span><span class="NAME">this.form</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">bkElement</span><span class="PUNC">(</span><span class="STRN">"div"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">overflow</span><span class="PUNC">:</span><span class="STRN">"hidden"</span><span class="PUNC">,</span><span class="NAME">clear</span><span class="PUNC">:</span><span class="STRN">"both"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">appendTo</span><span class="PUNC">(</span><span class="NAME">this.form</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">D.txt</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">bkElement</span><span class="PUNC">(</span><span class="STRN">"label"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setAttributes</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="STRN">"for"</span><span class="PUNC">:</span><span class="NAME">itm</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setContent</span><span class="PUNC">(</span><span class="NAME">D.txt</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">margin</span><span class="PUNC">:</span><span class="STRN">"2px 4px"</span><span class="PUNC">,</span><span class="NAME">fontSize</span><span class="PUNC">:</span><span class="STRN">"13px"</span><span class="PUNC">,</span><span class="NAME">width</span><span class="PUNC">:</span><span class="STRN">"50px"</span><span class="PUNC">,</span><span class="NAME">lineHeight</span><span class="PUNC">:</span><span class="STRN">"20px"</span><span class="PUNC">,</span><span class="NAME">textAlign</span><span class="PUNC">:</span><span class="STRN">"right"</span><span class="PUNC">,</span><span class="STRN">"float"</span><span class="PUNC">:</span><span class="STRN">"left"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">appendTo</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="STRN">"text"</span><span class="PUNC">:</span><span class="NAME">this.inputs</span><span class="PUNC">[</span><span class="NAME">itm</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">bkElement</span><span class="PUNC">(</span><span class="STRN">"input"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setAttributes</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">id</span><span class="PUNC">:</span><span class="NAME">itm</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="NAME">F</span><span class="PUNC">,</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"text"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">margin</span><span class="PUNC">:</span><span class="STRN">"2px 0"</span><span class="PUNC">,</span><span class="NAME">fontSize</span><span class="PUNC">:</span><span class="STRN">"13px"</span><span class="PUNC">,</span><span class="STRN">"float"</span><span class="PUNC">:</span><span class="STRN">"left"</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">:</span><span class="STRN">"20px"</span><span class="PUNC">,</span><span class="NAME">border</span><span class="PUNC">:</span><span class="STRN">"1px solid #ccc"</span><span class="PUNC">,</span><span class="NAME">overflow</span><span class="PUNC">:</span><span class="STRN">"hidden"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="NAME">D.style</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">appendTo</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="STRN">"select"</span><span class="PUNC">:</span><span class="NAME">this.inputs</span><span class="PUNC">[</span><span class="NAME">itm</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">bkElement</span><span class="PUNC">(</span><span class="STRN">"select"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setAttributes</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">id</span><span class="PUNC">:</span><span class="NAME">itm</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">border</span><span class="PUNC">:</span><span class="STRN">"1px solid #ccc"</span><span class="PUNC">,</span><span class="STRN">"float"</span><span class="PUNC">:</span><span class="STRN">"left"</span><span class="PUNC">,</span><span class="NAME">margin</span><span class="PUNC">:</span><span class="STRN">"2px 0"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">appendTo</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">opt</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">D.options</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">E</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">bkElement</span><span class="PUNC">(</span><span class="STRN">"option"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setAttributes</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">value</span><span class="PUNC">:</span><span class="NAME">opt</span><span class="PUNC">,</span><span class="NAME">selected</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">opt</span><span class="PUNC">==</span><span class="NAME">F</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="STRN">"selected"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setContent</span><span class="PUNC">(</span><span class="NAME">D.options</span><span class="PUNC">[</span><span class="NAME">opt</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">appendTo</span><span class="PUNC">(</span><span class="NAME">this.inputs</span><span class="PUNC">[</span><span class="NAME">itm</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="STRN">"content"</span><span class="PUNC">:</span><span class="NAME">this.inputs</span><span class="PUNC">[</span><span class="NAME">itm</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">bkElement</span><span class="PUNC">(</span><span class="STRN">"textarea"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setAttributes</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">id</span><span class="PUNC">:</span><span class="NAME">itm</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">border</span><span class="PUNC">:</span><span class="STRN">"1px solid #ccc"</span><span class="PUNC">,</span><span class="STRN">"float"</span><span class="PUNC">:</span><span class="STRN">"left"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="NAME">D.style</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">appendTo</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.inputs</span><span class="PUNC">[</span><span class="NAME">itm</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">value</span><span class="PUNC">=</span><span class="NAME">F</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">bkElement</span><span class="PUNC">(</span><span class="STRN">"input"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setAttributes</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"submit"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">backgroundColor</span><span class="PUNC">:</span><span class="STRN">"#efefef"</span><span class="PUNC">,</span><span class="NAME">border</span><span class="PUNC">:</span><span class="STRN">"1px solid #ccc"</span><span class="PUNC">,</span><span class="NAME">margin</span><span class="PUNC">:</span><span class="STRN">"3px 0"</span><span class="PUNC">,</span><span class="STRN">"float"</span><span class="PUNC">:</span><span class="STRN">"left"</span><span class="PUNC">,</span><span class="NAME">clear</span><span class="PUNC">:</span><span class="STRN">"both"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">appendTo</span><span class="PUNC">(</span><span class="NAME">this.form</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.form.onsubmit</span><span class="PUNC">=</span><span class="NAME">bkLib.cancelEvent</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">submit</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">findElm</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NAME">E</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">this.ne.selectedInstance.getElm</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getElementsByTagName</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">C</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">C</span><span class="PUNC">&lt;</span><span class="NAME">D.length</span><span class="PUNC">;</span><span class="NAME">C</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">[</span><span class="NAME">C</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getAttribute</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">E</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">$BK</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">[</span><span class="NAME">C</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">removePane</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.pane</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.pane.remove</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.pane</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.ne.selectedInstance.restoreRng</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 62</span> 
<span class='line'> 63</span> 
<span class='line'> 64</span> 
<span class='line'> 65</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nicButtonTips</span><span class="PUNC">=</span><span class="NAME">bkClass.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">construct</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.ne</span><span class="PUNC">=</span><span class="NAME">A</span><span class="PUNC">;</span><span class="NAME">A.addEvent</span><span class="PUNC">(</span><span class="STRN">"buttonOver"</span><span class="PUNC">,</span><span class="NAME">this.show.closure</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addEvent</span><span class="PUNC">(</span><span class="STRN">"buttonOut"</span><span class="PUNC">,</span><span class="NAME">this.hide.closure</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">show</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.timer</span><span class="PUNC">=</span><span class="NAME">setTimeout</span><span class="PUNC">(</span><span class="NAME">this.create.closure</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">400</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">create</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.timer</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.pane</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.pane</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">nicEditorPane</span><span class="PUNC">(</span><span class="NAME">A.button</span><span class="PUNC">,</span><span class="NAME">this.ne</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">fontSize</span><span class="PUNC">:</span><span class="STRN">"12px"</span><span class="PUNC">,</span><span class="NAME">marginTop</span><span class="PUNC">:</span><span class="STRN">"5px"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.pane.setContent</span><span class="PUNC">(</span><span class="NAME">A.options.name</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">hide</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.timer</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">clearTimeout</span><span class="PUNC">(</span><span class="NAME">this.timer</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.pane</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.pane</span><span class="PUNC">=</span><span class="NAME">this.pane.remove</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">nicEditors.registerPlugin</span><span class="PUNC">(</span><span class="NAME">nicButtonTips</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 66</span> 
<span class='line'> 67</span> 
<span class='line'> 68</span> 
<span class='line'> 69</span> 
<span class='line'> 70</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nicSelectOptions</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 71</span> </span><span class="WHIT">	</span><span class="NAME">buttons</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 72</span> </span><span class="WHIT">		</span><span class="STRN">'fontSize'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">__</span><span class="PUNC">(</span><span class="STRN">'Select Font Size'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'nicEditorFontSizeSelect'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">command</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'fontsize'</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 73</span> </span><span class="WHIT">		</span><span class="STRN">'fontFamily'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">__</span><span class="PUNC">(</span><span class="STRN">'Select Font Family'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'nicEditorFontFamilySelect'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">command</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'fontname'</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 74</span> </span><span class="WHIT">		</span><span class="STRN">'fontFormat'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">__</span><span class="PUNC">(</span><span class="STRN">'Select Font Format'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'nicEditorFontFormatSelect'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">command</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'formatBlock'</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 75</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 76</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 77</span> 
<span class='line'> 78</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nicEditorSelect</span><span class="PUNC">=</span><span class="NAME">bkClass.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">construct</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.options</span><span class="PUNC">=</span><span class="NAME">C.buttons</span><span class="PUNC">[</span><span class="NAME">A</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.elm</span><span class="PUNC">=</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">this.ne</span><span class="PUNC">=</span><span class="NAME">B</span><span class="PUNC">;</span><span class="NAME">this.name</span><span class="PUNC">=</span><span class="NAME">A</span><span class="PUNC">;</span><span class="NAME">this.selOptions</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.margin</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">bkElement</span><span class="PUNC">(</span><span class="STRN">"div"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="STRN">"float"</span><span class="PUNC">:</span><span class="STRN">"left"</span><span class="PUNC">,</span><span class="NAME">margin</span><span class="PUNC">:</span><span class="STRN">"2px 1px 0 1px"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">appendTo</span><span class="PUNC">(</span><span class="NAME">this.elm</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.contain</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">bkElement</span><span class="PUNC">(</span><span class="STRN">"div"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">width</span><span class="PUNC">:</span><span class="STRN">"90px"</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">:</span><span class="STRN">"20px"</span><span class="PUNC">,</span><span class="NAME">cursor</span><span class="PUNC">:</span><span class="STRN">"pointer"</span><span class="PUNC">,</span><span class="NAME">overflow</span><span class="PUNC">:</span><span class="STRN">"hidden"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">"selectContain"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addEvent</span><span class="PUNC">(</span><span class="STRN">"click"</span><span class="PUNC">,</span><span class="NAME">this.toggle.closure</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">appendTo</span><span class="PUNC">(</span><span class="NAME">this.margin</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.items</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">bkElement</span><span class="PUNC">(</span><span class="STRN">"div"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">overflow</span><span class="PUNC">:</span><span class="STRN">"hidden"</span><span class="PUNC">,</span><span class="NAME">zoom</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">border</span><span class="PUNC">:</span><span class="STRN">"1px solid #ccc"</span><span class="PUNC">,</span><span class="NAME">paddingLeft</span><span class="PUNC">:</span><span class="STRN">"3px"</span><span class="PUNC">,</span><span class="NAME">backgroundColor</span><span class="PUNC">:</span><span class="STRN">"#fff"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">appendTo</span><span class="PUNC">(</span><span class="NAME">this.contain</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.control</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">bkElement</span><span class="PUNC">(</span><span class="STRN">"div"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">overflow</span><span class="PUNC">:</span><span class="STRN">"hidden"</span><span class="PUNC">,</span><span class="STRN">"float"</span><span class="PUNC">:</span><span class="STRN">"right"</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">:</span><span class="STRN">"18px"</span><span class="PUNC">,</span><span class="NAME">width</span><span class="PUNC">:</span><span class="STRN">"16px"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">"selectControl"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="NAME">this.ne.getIcon</span><span class="PUNC">(</span><span class="STRN">"arrow"</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">appendTo</span><span class="PUNC">(</span><span class="NAME">this.items</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.txt</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">bkElement</span><span class="PUNC">(</span><span class="STRN">"div"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">overflow</span><span class="PUNC">:</span><span class="STRN">"hidden"</span><span class="PUNC">,</span><span class="STRN">"float"</span><span class="PUNC">:</span><span class="STRN">"left"</span><span class="PUNC">,</span><span class="NAME">width</span><span class="PUNC">:</span><span class="STRN">"66px"</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">:</span><span class="STRN">"14px"</span><span class="PUNC">,</span><span class="NAME">marginTop</span><span class="PUNC">:</span><span class="STRN">"1px"</span><span class="PUNC">,</span><span class="NAME">fontFamily</span><span class="PUNC">:</span><span class="STRN">"sans-serif"</span><span class="PUNC">,</span><span class="NAME">textAlign</span><span class="PUNC">:</span><span class="STRN">"center"</span><span class="PUNC">,</span><span class="NAME">fontSize</span><span class="PUNC">:</span><span class="STRN">"12px"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">"selectTxt"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">appendTo</span><span class="PUNC">(</span><span class="NAME">this.items</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">window.opera</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.contain.onmousedown</span><span class="PUNC">=</span><span class="NAME">this.control.onmousedown</span><span class="PUNC">=</span><span class="NAME">this.txt.onmousedown</span><span class="PUNC">=</span><span class="NAME">bkLib.cancelEvent</span><span class="PUNC">}</span><span class="NAME">this.margin.noSelect</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.ne.addEvent</span><span class="PUNC">(</span><span class="STRN">"selected"</span><span class="PUNC">,</span><span class="NAME">this.enable.closure</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addEvent</span><span class="PUNC">(</span><span class="STRN">"blur"</span><span class="PUNC">,</span><span class="NAME">this.disable.closure</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.disable</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.init</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">disable</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.isDisabled</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">;</span><span class="NAME">this.close</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.contain.setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">opacity</span><span class="PUNC">:</span><span class="NUMB">0.6</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">enable</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.isDisabled</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="NAME">this.close</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.contain.setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">opacity</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setDisplay</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.txt.setContent</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">toggle</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.isDisabled</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">(</span><span class="NAME">this.pane</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">this.close</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.open</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">open</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.pane</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">nicEditorPane</span><span class="PUNC">(</span><span class="NAME">this.items</span><span class="PUNC">,</span><span class="NAME">this.ne</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">width</span><span class="PUNC">:</span><span class="STRN">"88px"</span><span class="PUNC">,</span><span class="NAME">padding</span><span class="PUNC">:</span><span class="STRN">"0px"</span><span class="PUNC">,</span><span class="NAME">borderTop</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">borderLeft</span><span class="PUNC">:</span><span class="STRN">"1px solid #ccc"</span><span class="PUNC">,</span><span class="NAME">borderRight</span><span class="PUNC">:</span><span class="STRN">"1px solid #ccc"</span><span class="PUNC">,</span><span class="NAME">borderBottom</span><span class="PUNC">:</span><span class="STRN">"0px"</span><span class="PUNC">,</span><span class="NAME">backgroundColor</span><span class="PUNC">:</span><span class="STRN">"#fff"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">C</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">C</span><span class="PUNC">&lt;</span><span class="NAME">this.selOptions.length</span><span class="PUNC">;</span><span class="NAME">C</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">this.selOptions</span><span class="PUNC">[</span><span class="NAME">C</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">bkElement</span><span class="PUNC">(</span><span class="STRN">"div"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">overflow</span><span class="PUNC">:</span><span class="STRN">"hidden"</span><span class="PUNC">,</span><span class="NAME">borderBottom</span><span class="PUNC">:</span><span class="STRN">"1px solid #ccc"</span><span class="PUNC">,</span><span class="NAME">width</span><span class="PUNC">:</span><span class="STRN">"88px"</span><span class="PUNC">,</span><span class="NAME">textAlign</span><span class="PUNC">:</span><span class="STRN">"left"</span><span class="PUNC">,</span><span class="NAME">overflow</span><span class="PUNC">:</span><span class="STRN">"hidden"</span><span class="PUNC">,</span><span class="NAME">cursor</span><span class="PUNC">:</span><span class="STRN">"pointer"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">D</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">bkElement</span><span class="PUNC">(</span><span class="STRN">"div"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">padding</span><span class="PUNC">:</span><span class="STRN">"0px 4px"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setContent</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">appendTo</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">noSelect</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">D.addEvent</span><span class="PUNC">(</span><span class="STRN">"click"</span><span class="PUNC">,</span><span class="NAME">this.update.closure</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addEvent</span><span class="PUNC">(</span><span class="STRN">"mouseover"</span><span class="PUNC">,</span><span class="NAME">this.over.closure</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">D</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addEvent</span><span class="PUNC">(</span><span class="STRN">"mouseout"</span><span class="PUNC">,</span><span class="NAME">this.out.closure</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">D</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setAttributes</span><span class="PUNC">(</span><span class="STRN">"id"</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.pane.append</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">window.opera</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">D.onmousedown</span><span class="PUNC">=</span><span class="NAME">bkLib.cancelEvent</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">close</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.pane</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.pane</span><span class="PUNC">=</span><span class="NAME">this.pane.remove</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">over</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">A.setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">backgroundColor</span><span class="PUNC">:</span><span class="STRN">"#ccc"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">out</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">A.setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">backgroundColor</span><span class="PUNC">:</span><span class="STRN">"#fff"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">add</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.selOptions.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">update</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.ne.nicCommand</span><span class="PUNC">(</span><span class="NAME">this.options.command</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.close</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nicEditorFontSizeSelect</span><span class="PUNC">=</span><span class="NAME">nicEditorSelect.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">sel</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="STRN">"1&nbsp;(8pt)"</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">:</span><span class="STRN">"2&nbsp;(10pt)"</span><span class="PUNC">,</span><span class="NUMB">3</span><span class="PUNC">:</span><span class="STRN">"3&nbsp;(12pt)"</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">:</span><span class="STRN">"4&nbsp;(14pt)"</span><span class="PUNC">,</span><span class="NUMB">5</span><span class="PUNC">:</span><span class="STRN">"5&nbsp;(18pt)"</span><span class="PUNC">,</span><span class="NUMB">6</span><span class="PUNC">:</span><span class="STRN">"6&nbsp;(24pt)"</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">init</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.setDisplay</span><span class="PUNC">(</span><span class="STRN">"Font&nbsp;Size..."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">itm</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">this.sel</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.add</span><span class="PUNC">(</span><span class="NAME">itm</span><span class="PUNC">,</span><span class="STRN">'&lt;font size="'</span><span class="PUNC">+</span><span class="NAME">itm</span><span class="PUNC">+</span><span class="STRN">'">'</span><span class="PUNC">+</span><span class="NAME">this.sel</span><span class="PUNC">[</span><span class="NAME">itm</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="STRN">"&lt;/font>"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nicEditorFontFamilySelect</span><span class="PUNC">=</span><span class="NAME">nicEditorSelect.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">sel</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">arial</span><span class="PUNC">:</span><span class="STRN">"Arial"</span><span class="PUNC">,</span><span class="STRN">"comic sans ms"</span><span class="PUNC">:</span><span class="STRN">"Comic Sans"</span><span class="PUNC">,</span><span class="STRN">"courier new"</span><span class="PUNC">:</span><span class="STRN">"Courier New"</span><span class="PUNC">,</span><span class="NAME">georgia</span><span class="PUNC">:</span><span class="STRN">"Georgia"</span><span class="PUNC">,</span><span class="NAME">helvetica</span><span class="PUNC">:</span><span class="STRN">"Helvetica"</span><span class="PUNC">,</span><span class="NAME">impact</span><span class="PUNC">:</span><span class="STRN">"Impact"</span><span class="PUNC">,</span><span class="STRN">"times new roman"</span><span class="PUNC">:</span><span class="STRN">"Times"</span><span class="PUNC">,</span><span class="STRN">"trebuchet ms"</span><span class="PUNC">:</span><span class="STRN">"Trebuchet"</span><span class="PUNC">,</span><span class="NAME">verdana</span><span class="PUNC">:</span><span class="STRN">"Verdana"</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">init</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.setDisplay</span><span class="PUNC">(</span><span class="STRN">"Font&nbsp;Family..."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">itm</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">this.sel</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.add</span><span class="PUNC">(</span><span class="NAME">itm</span><span class="PUNC">,</span><span class="STRN">'&lt;font face="'</span><span class="PUNC">+</span><span class="NAME">itm</span><span class="PUNC">+</span><span class="STRN">'">'</span><span class="PUNC">+</span><span class="NAME">this.sel</span><span class="PUNC">[</span><span class="NAME">itm</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="STRN">"&lt;/font>"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nicEditorFontFormatSelect</span><span class="PUNC">=</span><span class="NAME">nicEditorSelect.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">sel</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">p</span><span class="PUNC">:</span><span class="STRN">"Paragraph"</span><span class="PUNC">,</span><span class="NAME">pre</span><span class="PUNC">:</span><span class="STRN">"Pre"</span><span class="PUNC">,</span><span class="NAME">h6</span><span class="PUNC">:</span><span class="STRN">"Heading&nbsp;6"</span><span class="PUNC">,</span><span class="NAME">h5</span><span class="PUNC">:</span><span class="STRN">"Heading&nbsp;5"</span><span class="PUNC">,</span><span class="NAME">h4</span><span class="PUNC">:</span><span class="STRN">"Heading&nbsp;4"</span><span class="PUNC">,</span><span class="NAME">h3</span><span class="PUNC">:</span><span class="STRN">"Heading&nbsp;3"</span><span class="PUNC">,</span><span class="NAME">h2</span><span class="PUNC">:</span><span class="STRN">"Heading&nbsp;2"</span><span class="PUNC">,</span><span class="NAME">h1</span><span class="PUNC">:</span><span class="STRN">"Heading&nbsp;1"</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">init</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.setDisplay</span><span class="PUNC">(</span><span class="STRN">"Font&nbsp;Format..."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">itm</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">this.sel</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">itm.toUpperCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.add</span><span class="PUNC">(</span><span class="STRN">"&lt;"</span><span class="PUNC">+</span><span class="NAME">A</span><span class="PUNC">+</span><span class="STRN">">"</span><span class="PUNC">,</span><span class="STRN">"&lt;"</span><span class="PUNC">+</span><span class="NAME">itm</span><span class="PUNC">+</span><span class="STRN">' style="padding: 0px; margin: 0px;">'</span><span class="PUNC">+</span><span class="NAME">this.sel</span><span class="PUNC">[</span><span class="NAME">itm</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="STRN">"&lt;/"</span><span class="PUNC">+</span><span class="NAME">A</span><span class="PUNC">+</span><span class="STRN">">"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">nicEditors.registerPlugin</span><span class="PUNC">(</span><span class="NAME">nicPlugin</span><span class="PUNC">,</span><span class="NAME">nicSelectOptions</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 79</span> 
<span class='line'> 80</span> 
<span class='line'> 81</span> 
<span class='line'> 82</span> 
<span class='line'> 83</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nicLinkOptions</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 84</span> </span><span class="WHIT">	</span><span class="NAME">buttons</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 85</span> </span><span class="WHIT">		</span><span class="STRN">'link'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'Add Link'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'nicLinkButton'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tags</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="STRN">'A'</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 86</span> </span><span class="WHIT">		</span><span class="STRN">'unlink'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'Remove Link'</span><span class="PUNC">,</span><span class="WHIT">  </span><span class="NAME">command</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'unlink'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">noActive</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 87</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 88</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 89</span> 
<span class='line'> 90</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nicLinkButton</span><span class="PUNC">=</span><span class="NAME">nicEditorAdvancedButton.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">addPane</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.ln</span><span class="PUNC">=</span><span class="NAME">this.ne.selectedInstance.selElm</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">parentTag</span><span class="PUNC">(</span><span class="STRN">"A"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.addForm</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="STRN">""</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"title"</span><span class="PUNC">,</span><span class="NAME">txt</span><span class="PUNC">:</span><span class="STRN">"Add/Edit Link"</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">href</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"text"</span><span class="PUNC">,</span><span class="NAME">txt</span><span class="PUNC">:</span><span class="STRN">"URL"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="STRN">"http://"</span><span class="PUNC">,</span><span class="NAME">style</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">width</span><span class="PUNC">:</span><span class="STRN">"150px"</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">title</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"text"</span><span class="PUNC">,</span><span class="NAME">txt</span><span class="PUNC">:</span><span class="STRN">"Title"</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">target</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"select"</span><span class="PUNC">,</span><span class="NAME">txt</span><span class="PUNC">:</span><span class="STRN">"Open In"</span><span class="PUNC">,</span><span class="NAME">options</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="STRN">""</span><span class="PUNC">:</span><span class="STRN">"Current Window"</span><span class="PUNC">,</span><span class="NAME">_blank</span><span class="PUNC">:</span><span class="STRN">"New Window"</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">style</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">width</span><span class="PUNC">:</span><span class="STRN">"100px"</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">this.ln</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">submit</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">this.inputs.href.value</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">==</span><span class="STRN">"http://"</span><span class="PUNC">||</span><span class="NAME">A</span><span class="PUNC">==</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">alert</span><span class="PUNC">(</span><span class="STRN">"You must enter a URL to Create a Link"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">}</span><span class="NAME">this.removePane</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.ln</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="STRN">"javascript:nicTemp();"</span><span class="PUNC">;</span><span class="NAME">this.ne.nicCommand</span><span class="PUNC">(</span><span class="STRN">"createlink"</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.ln</span><span class="PUNC">=</span><span class="NAME">this.findElm</span><span class="PUNC">(</span><span class="STRN">"A"</span><span class="PUNC">,</span><span class="STRN">"href"</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.ln</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.ln.setAttributes</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">href</span><span class="PUNC">:</span><span class="NAME">this.inputs.href.value</span><span class="PUNC">,</span><span class="NAME">title</span><span class="PUNC">:</span><span class="NAME">this.inputs.title.value</span><span class="PUNC">,</span><span class="NAME">target</span><span class="PUNC">:</span><span class="NAME">this.inputs.target.options</span><span class="PUNC">[</span><span class="NAME">this.inputs.target.selectedIndex</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">value</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">nicEditors.registerPlugin</span><span class="PUNC">(</span><span class="NAME">nicPlugin</span><span class="PUNC">,</span><span class="NAME">nicLinkOptions</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 91</span> 
<span class='line'> 92</span> 
<span class='line'> 93</span> 
<span class='line'> 94</span> 
<span class='line'> 95</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nicColorOptions</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 96</span> </span><span class="WHIT">	</span><span class="NAME">buttons</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 97</span> </span><span class="WHIT">		</span><span class="STRN">'forecolor'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">__</span><span class="PUNC">(</span><span class="STRN">'Change Text Color'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'nicEditorColorButton'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">noClose</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 98</span> </span><span class="WHIT">		</span><span class="STRN">'bgcolor'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">__</span><span class="PUNC">(</span><span class="STRN">'Change Background Color'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'nicEditorBgColorButton'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">noClose</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 99</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>100</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>101</span> 
<span class='line'>102</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nicEditorColorButton</span><span class="PUNC">=</span><span class="NAME">nicEditorAdvancedButton.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">addPane</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">D</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="STRN">"00"</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="STRN">"33"</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">:</span><span class="STRN">"66"</span><span class="PUNC">,</span><span class="NUMB">3</span><span class="PUNC">:</span><span class="STRN">"99"</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">:</span><span class="STRN">"CC"</span><span class="PUNC">,</span><span class="NUMB">5</span><span class="PUNC">:</span><span class="STRN">"FF"</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">H</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">bkElement</span><span class="PUNC">(</span><span class="STRN">"DIV"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">width</span><span class="PUNC">:</span><span class="STRN">"270px"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">A</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">D</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">F</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">D</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">E</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">D</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">I</span><span class="PUNC">=</span><span class="STRN">"#"</span><span class="PUNC">+</span><span class="NAME">D</span><span class="PUNC">[</span><span class="NAME">A</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">D</span><span class="PUNC">[</span><span class="NAME">E</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">D</span><span class="PUNC">[</span><span class="NAME">F</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">C</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">bkElement</span><span class="PUNC">(</span><span class="STRN">"DIV"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">cursor</span><span class="PUNC">:</span><span class="STRN">"pointer"</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">:</span><span class="STRN">"15px"</span><span class="PUNC">,</span><span class="STRN">"float"</span><span class="PUNC">:</span><span class="STRN">"left"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">appendTo</span><span class="PUNC">(</span><span class="NAME">H</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">G</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">bkElement</span><span class="PUNC">(</span><span class="STRN">"DIV"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">border</span><span class="PUNC">:</span><span class="STRN">"2px solid "</span><span class="PUNC">+</span><span class="NAME">I</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">appendTo</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">bkElement</span><span class="PUNC">(</span><span class="STRN">"DIV"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">backgroundColor</span><span class="PUNC">:</span><span class="NAME">I</span><span class="PUNC">,</span><span class="NAME">overflow</span><span class="PUNC">:</span><span class="STRN">"hidden"</span><span class="PUNC">,</span><span class="NAME">width</span><span class="PUNC">:</span><span class="STRN">"11px"</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">:</span><span class="STRN">"11px"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addEvent</span><span class="PUNC">(</span><span class="STRN">"click"</span><span class="PUNC">,</span><span class="NAME">this.colorSelect.closure</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addEvent</span><span class="PUNC">(</span><span class="STRN">"mouseover"</span><span class="PUNC">,</span><span class="NAME">this.on.closure</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addEvent</span><span class="PUNC">(</span><span class="STRN">"mouseout"</span><span class="PUNC">,</span><span class="NAME">this.off.closure</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">appendTo</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">window.opera</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">C.onmousedown</span><span class="PUNC">=</span><span class="NAME">B.onmousedown</span><span class="PUNC">=</span><span class="NAME">bkLib.cancelEvent</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">this.pane.append</span><span class="PUNC">(</span><span class="NAME">H.noSelect</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">colorSelect</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.ne.nicCommand</span><span class="PUNC">(</span><span class="STRN">"foreColor"</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.removePane</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">on</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">A.setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">border</span><span class="PUNC">:</span><span class="STRN">"2px solid #000"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">off</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">A.setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">border</span><span class="PUNC">:</span><span class="STRN">"2px solid "</span><span class="PUNC">+</span><span class="NAME">B</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nicEditorBgColorButton</span><span class="PUNC">=</span><span class="NAME">nicEditorColorButton.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">colorSelect</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.ne.nicCommand</span><span class="PUNC">(</span><span class="STRN">"hiliteColor"</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.removePane</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">nicEditors.registerPlugin</span><span class="PUNC">(</span><span class="NAME">nicPlugin</span><span class="PUNC">,</span><span class="NAME">nicColorOptions</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>103</span> 
<span class='line'>104</span> 
<span class='line'>105</span> 
<span class='line'>106</span> 
<span class='line'>107</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nicImageOptions</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>108</span> </span><span class="WHIT">	</span><span class="NAME">buttons</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>109</span> </span><span class="WHIT">		</span><span class="STRN">'image'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'Add Image'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'nicImageButton'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tags</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="STRN">'IMG'</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>110</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>111</span> </span><span class="WHIT">	
<span class='line'>112</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>113</span> 
<span class='line'>114</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nicImageButton</span><span class="PUNC">=</span><span class="NAME">nicEditorAdvancedButton.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">addPane</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.im</span><span class="PUNC">=</span><span class="NAME">this.ne.selectedInstance.selElm</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">parentTag</span><span class="PUNC">(</span><span class="STRN">"IMG"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.addForm</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="STRN">""</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"title"</span><span class="PUNC">,</span><span class="NAME">txt</span><span class="PUNC">:</span><span class="STRN">"Add/Edit Image"</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">src</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"text"</span><span class="PUNC">,</span><span class="NAME">txt</span><span class="PUNC">:</span><span class="STRN">"URL"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="STRN">"http://"</span><span class="PUNC">,</span><span class="NAME">style</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">width</span><span class="PUNC">:</span><span class="STRN">"150px"</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">alt</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"text"</span><span class="PUNC">,</span><span class="NAME">txt</span><span class="PUNC">:</span><span class="STRN">"Alt Text"</span><span class="PUNC">,</span><span class="NAME">style</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">width</span><span class="PUNC">:</span><span class="STRN">"100px"</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">align</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"select"</span><span class="PUNC">,</span><span class="NAME">txt</span><span class="PUNC">:</span><span class="STRN">"Align"</span><span class="PUNC">,</span><span class="NAME">options</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">none</span><span class="PUNC">:</span><span class="STRN">"Default"</span><span class="PUNC">,</span><span class="NAME">left</span><span class="PUNC">:</span><span class="STRN">"Left"</span><span class="PUNC">,</span><span class="NAME">right</span><span class="PUNC">:</span><span class="STRN">"Right"</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">this.im</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">submit</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">this.inputs.src.value</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">==</span><span class="STRN">""</span><span class="PUNC">||</span><span class="NAME">C</span><span class="PUNC">==</span><span class="STRN">"http://"</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">alert</span><span class="PUNC">(</span><span class="STRN">"You must enter a Image URL to insert"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">}</span><span class="NAME">this.removePane</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.im</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">=</span><span class="STRN">"javascript:nicImTemp();"</span><span class="PUNC">;</span><span class="NAME">this.ne.nicCommand</span><span class="PUNC">(</span><span class="STRN">"insertImage"</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.im</span><span class="PUNC">=</span><span class="NAME">this.findElm</span><span class="PUNC">(</span><span class="STRN">"IMG"</span><span class="PUNC">,</span><span class="STRN">"src"</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.im</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.im.setAttributes</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">src</span><span class="PUNC">:</span><span class="NAME">this.inputs.src.value</span><span class="PUNC">,</span><span class="NAME">alt</span><span class="PUNC">:</span><span class="NAME">this.inputs.alt.value</span><span class="PUNC">,</span><span class="NAME">align</span><span class="PUNC">:</span><span class="NAME">this.inputs.align.value</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">nicEditors.registerPlugin</span><span class="PUNC">(</span><span class="NAME">nicPlugin</span><span class="PUNC">,</span><span class="NAME">nicImageOptions</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>115</span> 
<span class='line'>116</span> 
<span class='line'>117</span> 
<span class='line'>118</span> 
<span class='line'>119</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nicSaveOptions</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>120</span> </span><span class="WHIT">	</span><span class="NAME">buttons</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>121</span> </span><span class="WHIT">		</span><span class="STRN">'save'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">__</span><span class="PUNC">(</span><span class="STRN">'Save this content'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'nicEditorSaveButton'</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>122</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>123</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>124</span> 
<span class='line'>125</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nicEditorSaveButton</span><span class="PUNC">=</span><span class="NAME">nicEditorButton.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.ne.options.onSave</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.margin.setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">display</span><span class="PUNC">:</span><span class="STRN">"none"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">mouseClick</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">this.ne.options.onSave</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">this.ne.selectedInstance</span><span class="PUNC">;</span><span class="NAME">B</span><span class="PUNC">(</span><span class="NAME">A.getContent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">A.elm.id</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">nicEditors.registerPlugin</span><span class="PUNC">(</span><span class="NAME">nicPlugin</span><span class="PUNC">,</span><span class="NAME">nicSaveOptions</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>126</span> 
<span class='line'>127</span> 
<span class='line'>128</span> 
<span class='line'>129</span> </span><span class="COMM">/**
<span class='line'>130</span>  * nicCode
<span class='line'>131</span>  * @description: Adds button to edit the HTML in a editor
<span class='line'>132</span>  * @requires: nicCore, nicPane, nicAdvancedButton
<span class='line'>133</span>  * @author: Brian Kirchoff
<span class='line'>134</span>  * @version: 0.9.0
<span class='line'>135</span>  */</span><span class="WHIT">
<span class='line'>136</span> 
<span class='line'>137</span> </span><span class="COMM">/* START CONFIG */</span><span class="WHIT">
<span class='line'>138</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nicCodeOptions</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>139</span> </span><span class="WHIT">	</span><span class="NAME">buttons</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>140</span> </span><span class="WHIT">		</span><span class="STRN">'xhtml'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'Edit HTML'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'nicCodeButton'</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>141</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>142</span> </span><span class="WHIT">	
<span class='line'>143</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>144</span> </span><span class="COMM">/* END CONFIG */</span><span class="WHIT">
<span class='line'>145</span> 
<span class='line'>146</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nicCodeButton</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">nicEditorAdvancedButton.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>147</span> </span><span class="WHIT">	</span><span class="NAME">width</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'350px'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>148</span> </span><span class="WHIT">		
<span class='line'>149</span> 	</span><span class="NAME">addPane</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>150</span> </span><span class="WHIT">		</span><span class="NAME">this.addForm</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>151</span> </span><span class="WHIT">			</span><span class="STRN">''</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'title'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">txt</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'Edit HTML'</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>152</span> </span><span class="WHIT">			</span><span class="STRN">'code'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'content'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'value'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.ne.selectedInstance.getContent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">style</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">width</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'340px'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">height</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'200px'</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>153</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>154</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>155</span> </span><span class="WHIT">	
<span class='line'>156</span> 	</span><span class="NAME">submit</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>157</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">code</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.inputs</span><span class="PUNC">[</span><span class="STRN">'code'</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>158</span> </span><span class="WHIT">		</span><span class="NAME">this.ne.selectedInstance.setContent</span><span class="PUNC">(</span><span class="NAME">code</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>159</span> </span><span class="WHIT">		</span><span class="NAME">this.removePane</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>160</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>161</span> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>162</span> 
<span class='line'>163</span> </span><span class="NAME">nicEditors.registerPlugin</span><span class="PUNC">(</span><span class="NAME">nicPlugin</span><span class="PUNC">,</span><span class="NAME">nicCodeOptions</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>164</span> 
<span class='line'>165</span> 
<span class='line'>166</span> 
<span class='line'>167</span> </span><span class="NAME">nicEditor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">nicEditor.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>168</span> </span><span class="WHIT">        </span><span class="NAME">floatingPanel</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>169</span> </span><span class="WHIT">                </span><span class="NAME">this.floating</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">bkElement</span><span class="PUNC">(</span><span class="STRN">'DIV'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">position</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'absolute'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">top</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'-1000px'</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">appendTo</span><span class="PUNC">(</span><span class="NAME">document.body</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>170</span> </span><span class="WHIT">                </span><span class="NAME">this.addEvent</span><span class="PUNC">(</span><span class="STRN">'focus'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.reposition.closure</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addEvent</span><span class="PUNC">(</span><span class="STRN">'blur'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.hide.closure</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>171</span> </span><span class="WHIT">                </span><span class="NAME">this.setPanel</span><span class="PUNC">(</span><span class="NAME">this.floating</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>172</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>173</span> </span><span class="WHIT">        
<span class='line'>174</span>         </span><span class="NAME">reposition</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>175</span> </span><span class="WHIT">                </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.selectedInstance.e</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>176</span> </span><span class="WHIT">                </span><span class="NAME">this.floating.setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">width</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">e.getStyle</span><span class="PUNC">(</span><span class="STRN">'width'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">e.clientWidth</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">'px'</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>177</span> </span><span class="WHIT">                </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">top</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">position</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">top</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">this.floating</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">height</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="COMM">//e.offsetTop-this.floating.offsetHeight;</span><span class="WHIT">
<span class='line'>178</span> </span><span class="WHIT">                </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">top</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>179</span> </span><span class="WHIT">                        </span><span class="NAME">top</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">position</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">top</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">height</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="COMM">//e.offsetTop+e.offsetHeight;</span><span class="WHIT">
<span class='line'>180</span> </span><span class="WHIT">                </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>181</span> </span><span class="WHIT">                </span><span class="NAME">this.floating.setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">top</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">top</span><span class="PUNC">+</span><span class="STRN">'px'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">left</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">position</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">left</span><span class="PUNC">+</span><span class="STRN">'px'</span><span class="WHIT"> </span><span class="COMM">/*e.offsetLeft+'px'*/</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">display</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'block'</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>182</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>183</span> </span><span class="WHIT">        
<span class='line'>184</span>         </span><span class="NAME">hide</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>185</span> </span><span class="WHIT">                </span><span class="NAME">this.floating.setStyle</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">top</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'-1000px'</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>186</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>187</span> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>188</span> </span></pre></body></html>